#Если Сервер Или ТолстыйКлиентОбычноеПриложение Или ВнешнееСоединение Тогда

#Область ОбработчикиСобытий

Процедура ПриКомпоновкеРезультата(ДокументРезультат, ДанныеРасшифровки, СтандартнаяОбработка)
	
	Замер = ОценкаПроизводительности.НачатьЗамерДлительнойОперации("Отчет.СебестоимостьТоваров.МодульОбъекта.ПриКомпоновкеРезультата");
	
	СтандартнаяОбработка = Ложь;
	ПользовательскиеНастройкиМодифицированы = Ложь;
	
	КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек);
	
	УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы);
	
	УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек);
	УдалитьЦеновыеПоказателиИзВыбранныхПолейРасшифровки(КомпоновщикНастроек);
	
	НастройкиОтчета = КомпоновщикНастроек.ПолучитьНастройки();
	
	Если ИспользуютсяОтборыПоРесурсам(НастройкиОтчета.Отбор.Элементы, ДокументРезультат) Тогда
		Возврат;
	КонецЕсли;
	
	НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("ВыражениеПользовательскогоПоляНачальныйОстаток",
		НСтр("ru = 'Начальный остаток'"));
	НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("ВыражениеПользовательскогоПоляВсегоПриход",
		НСтр("ru = 'Всего приход'"));
	НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("ВыражениеПользовательскогоПоляВсегоРасход",
		НСтр("ru = 'Всего расход'"));
	НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("ВыражениеПользовательскогоПоляКонечныйОстаток",
		НСтр("ru = 'Конечный остаток'"));
		
	ИсключаемыеХозОперации = Новый Массив();
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПеремещениеТоваров);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ЗакупкаУПоставщикаПоступлениеИзТоваровВПути);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ЗакупкаПоИмпортуПоступлениеИзТоваровВПути);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ЗакупкаВСтранахЕАЭСПоступлениеИзТоваровВПути);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаПродукцииИзКладовой);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаПродукцииИзПроизводства);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаВПроизводство);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.СписаниеРасходовНаПартииПроизводства);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаМатериаловВКладовую);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаМатериаловВПроизводство);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратМатериаловИзКладовой);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратМатериаловИзПроизводства);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаНаХранениеСПравомПродажи);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратОтХранителя);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаНаКомиссию);
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратОтКомиссионера);
	//++ Устарело_Переработка24
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаПереработчику);
	//-- Устарело_Переработка24
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ПередачаПереработчику2_5);
	//++ Устарело_Переработка24
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратОтПереработчика);
	//-- Устарело_Переработка24
	ИсключаемыеХозОперации.Добавить(Перечисления.ХозяйственныеОперации.ВозвратОтПереработчика2_5);
	НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("ИсключаемыеХозОперации", ИсключаемыеХозОперации);
	
	ПараметрПериод = КомпоновкаДанныхКлиентСервер.ПолучитьПараметр(КомпоновщикНастроек, "Период").Значение; // СтандартныйПериод
	Если НЕ ЗначениеЗаполнено(ПараметрПериод.ДатаОкончания) Тогда
		ПериодПоследнихДвижений = ПартионныйУчетСервер.ПериодПоследнихДвиженийРегистраСебестоимость();   
		ПараметрПериод.ДатаОкончания = Мин(ТекущаяДатаСеанса(), ПериодПоследнихДвижений);
		НастройкиОтчета.ПараметрыДанных.УстановитьЗначениеПараметра("Период", ПараметрПериод);
	КонецЕсли;
	
	МассивИспользуемыхПолейКД = Новый Массив();
	РасчетСебестоимостиПрикладныеАлгоритмы.ДобавитьВыбранныеПоляКомпоновкиДанныхВМассив(НастройкиОтчета.Выбор.Элементы,
		МассивИспользуемыхПолейКД);
	РасчетСебестоимостиПрикладныеАлгоритмы.ПодменитьПутьВВыбранномПолеКомпоновкиДанных(МассивИспользуемыхПолейКД,
		"АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения",
		"АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмеренияОтчета");
	
	ТекстЗапроса = ТекстЗапроса();
	
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаВесУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаВесУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
		
	ТекстЗапроса = СтрЗаменить(
		ТекстЗапроса, 
		"&ТекстЗапросаОбъемУпаковки", 
		Справочники.УпаковкиЕдиницыИзмерения.ТекстЗапросаОбъемУпаковки("АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения", "АналитикаНоменклатуры.Номенклатура"));
	
	НаборДанных = СхемаКомпоновкиДанных.НаборыДанных.СебестоимостьСДетализацией; // НаборДанныхОбъединениеСхемыКомпоновкиДанных
	НаборДанных.Запрос = ТекстЗапроса;
	
	КомпоновщикМакета = Новый КомпоновщикМакетаКомпоновкиДанных;
	МакетКомпоновки = КомпоновщикМакета.Выполнить(СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	// Проверим, используются ли оборотные аналитики
	КомпоновкаДанныхСервер.ОптимизацияИспользованияОборотнойАналитики(МакетКомпоновки, СхемаКомпоновкиДанных, НастройкиОтчета, ДанныеРасшифровки);
	
	КомпоновкаДанныхСервер.УстановитьЗаголовкиМакетаКомпоновки(СтруктураЗаголовковПолей(), МакетКомпоновки);
	
	ПроцессорКомпоновки = Новый ПроцессорКомпоновкиДанных;
	ПроцессорКомпоновки.Инициализировать(МакетКомпоновки, , ДанныеРасшифровки, Истина);
	
	ПроцессорВывода = Новый ПроцессорВыводаРезультатаКомпоновкиДанныхВТабличныйДокумент;
	ПроцессорВывода.УстановитьДокумент(ДокументРезультат);
	
	ПроверяемыеПоля = Новый Массив;
	ПроверяемыеПоля.Добавить("Партнер");
	ПроверяемыеПоля.Добавить("Менеджер");
	ПроверяемыеПоля.Добавить("Подразделение");
	ПроверяемыеПоля.Добавить("Сделка");
	
	РасчетСебестоимостиПрикладныеАлгоритмы.ДобавитьПредупреждениеОбОсобенностяхФормированияОтчета(
		ДокументРезультат,
		КомпоновщикНастроек,
		ПроверяемыеПоля,
		Ложь,  // Актуализировать партии
		"СтруктураПредприятия.Организация");
	
	РасчетСебестоимостиПрикладныеАлгоритмы.АктуализироватьПартииДляОтчетов(
		ДокументРезультат,
		КомпоновщикНастроек,
		"СтруктураПредприятия.Организация");
		
	РасчетСебестоимостиПрикладныеАлгоритмы.ДобавитьПредупреждениеОПредварительномЗакрытииМесяца(ДокументРезультат, КомпоновщикНастроек);
	
	ПроцессорВывода.Вывести(ПроцессорКомпоновки);
	
	КомпоновкаДанныхСервер.ОформитьДиаграммыОтчета(КомпоновщикНастроек, ДокументРезультат);
	
	ВспомогательныеПараметры = Новый Массив;
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметры);
	КомпоновкаДанныхСервер.СкрытьВспомогательныеПараметрыОтчета(
		СхемаКомпоновкиДанных, КомпоновщикНастроек, ДокументРезультат, ВспомогательныеПараметрыОтчета());
	
	// Сообщим форме отчета, что настройки модифицированы
	Если ПользовательскиеНастройкиМодифицированы Тогда
		КомпоновщикНастроек.ПользовательскиеНастройки.ДополнительныеСвойства.Вставить("ПользовательскиеНастройкиМодифицированы", Истина);
	КонецЕсли;
	
	ОценкаПроизводительности.ЗакончитьЗамерДлительнойОперации(Замер, ДокументРезультат.ВысотаТаблицы);
	
КонецПроцедуры

#КонецОбласти
	
#Область СлужебныйПрограммныйИнтерфейс

// Настройки общей формы отчета подсистемы "Варианты отчетов".
//
// Параметры:
//   Форма - ФормаКлиентскогоПриложения - Форма отчета.
//   КлючВарианта - Строка - Имя предопределенного варианта отчета или уникальный идентификатор пользовательского.
//   Настройки - См. ОтчетыКлиентСервер.ПолучитьНастройкиОтчетаПоУмолчанию
//
Процедура ОпределитьНастройкиФормы(Форма, КлючВарианта, Настройки) Экспорт
	
	Настройки.События.ПередЗагрузкойНастроекВКомпоновщик = Истина;
	
КонецПроцедуры

Процедура ПередЗагрузкойНастроекВКомпоновщик(Контекст, КлючСхемы, КлючВарианта, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД) Экспорт
	
	Если ТипЗнч(Контекст) = Тип("ФормаКлиентскогоПриложения") Тогда
		НастроитьПараметрыОтчетаПоВариантуОтчета(Контекст.НастройкиОтчета, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД);
		ОтчетыСервер.ПодключитьСхему(ЭтотОбъект, Контекст, СхемаКомпоновкиДанных, КлючСхемы);
	КонецЕсли;
	
КонецПроцедуры

#КонецОбласти

#Область СлужебныеПроцедурыИФункции

Процедура КонтрольИспользованияАналитикиОборотов(КомпоновщикНастроек)
	Группировки = КомпоновкаДанныхКлиентСервер.ПолучитьГруппировки(КомпоновщикНастроек);
	
	Для Каждого Группировка Из Группировки Цикл
		ГруппировкаПоля = Группировка.Значение.ПоляГруппировки; // ПоляГруппировкиКомпоновкиДанных
		ПоляГруппировки = ГруппировкаПоля.Элементы;
		КоличествоПолейАналитикиОборотов = 0;
		Для Каждого ПолеГруппировки Из ПоляГруппировки Цикл 
			Если Найти(Строка(ПолеГруппировки.Поле), "АналитикаОборотов") >0 Тогда
				КоличествоПолейАналитикиОборотов = КоличествоПолейАналитикиОборотов + 1; 
			КонецЕсли;
			Если КоличествоПолейАналитикиОборотов > 1 Тогда
				ВызватьИсключение НСтр("ru= 'Множественное использование полей аналитики оборотов в группировках не поддерживается.'") ;
			КонецЕсли;
		КонецЦикла;
		Если КоличествоПолейАналитикиОборотов >= 1 И ПоляГруппировки.Количество() > 1 Тогда
			ВызватьИсключение НСтр("ru= 'Совместное использование в группировках полей аналитики оборотов и других полей не поддерживается.'") ;
		КонецЕсли;
	КонецЦикла;
КонецПроцедуры

// Функция проверки наличия полей ресурсов в отборах.
//
// Параметры:
//	ЭлементыОтбора - КоллекцияЭлементовОтбораКомпоновкиДанных - элементы отбора отчета
//	ДокументРезультат - ТабличныйДокумент - основной табличный документ отчета
//
// Возвращаемое значение:
//	Булево - признак наличия отборов по полям ресурсов.
//
Функция ИспользуютсяОтборыПоРесурсам(ЭлементыОтбора, ДокументРезультат)
	
	ЕстьОтбор = Ложь;
	
	ПоляРесурсовСОтборами = Новый Массив;
	
	Для Каждого ПолеИтогов Из СхемаКомпоновкиДанных.ПоляИтога Цикл
		
		ПолеОтбора = Новый ПолеКомпоновкиДанных(ПолеИтогов.ПутьКДанным);
		
		Если КомпоновкаДанныхКлиентСервер.ИспользуетсяОтбор(ЭлементыОтбора, ПолеОтбора, Истина) Тогда
			ПоляРесурсовСОтборами.Добавить(ПолеИтогов.ПутьКДанным);
		КонецЕсли;
		
	КонецЦикла;
	
	Если ПоляРесурсовСОтборами.Количество() > 0 Тогда 
		ВывестиПредупреждениеОбОтбореПоРесурсам(ДокументРезультат, ПоляРесурсовСОтборами);
		ЕстьОтбор = Истина;
	КонецЕсли;
	
	Возврат ЕстьОтбор;
	
КонецФункции

// Процедура вывода предупреждения в табличный документ.
//
// Параметры:
//	ДокументРезультат - ТабличныйДокумент - основной табличный документ отчета
//	СписокПолей - Массив - массив строк с именами полей
//	
Процедура ВывестиПредупреждениеОбОтбореПоРесурсам(ДокументРезультат, СписокПолей)
	
	ТекстПредупреждения = НСтр("ru ='В отчете ""Себестоимость товаров"" не поддерживаются общие отборы по количественным и стоимостным показателям для всего отчета (настройки отчета - закладка ""Фильтры"").
								|Такие отборы следует перенести в отборы группировок (настройки отчета -> закладка ""Структура"" -> кнопка ""Расширенный"" внизу окна настроек -> открыть конкретную группировку и установить отбор на закладке ""Фильтры"").
								|Отборы необходимо добавить во всех группировках, отмеченных для вывода в отчете (отмечены галочками на закладке ""Структура"").
								|Группировка ""Детализация до исходных затрат"" не поддерживает отборы по количеству.
								|
								|Отборы по следующим полям неоходимо отключить или перенести в группировки:'");
	
	Для Каждого Поле Из СписокПолей Цикл
		ТекстПредупреждения = ТекстПредупреждения + Символы.ПС
			+ СтроковыеФункцииКлиентСервер.ПодставитьПараметрыВСтроку(
						НСтр("ru =' - %1'"),
						Поле);
	КонецЦикла; 
		
	ТаблицаПредупреждение = Новый ТабличныйДокумент;
	ОбластьПредупреждение = ТаблицаПредупреждение.Область(1,1,1,1);
	
	ОбластьПредупреждение.Текст 	 = ТекстПредупреждения;
	ОбластьПредупреждение.ЦветТекста = ЦветаСтиля.ЦветОтрицательногоЧисла;
	
	ДокументРезультат.ВставитьОбласть(
		ОбластьПредупреждение,
		ДокументРезультат.Область(1,1,1,1),
		ТипСмещенияТабличногоДокумента.ПоВертикали);
	
КонецПроцедуры

// Процедура настройки параметров отчета.
//
// Параметры:
//	НастройкиОтчета - Структура - настройки отчета
//	НовыеНастройкиКД - НастройкиКомпоновкиДанных - настройки компоновки данных
//	НовыеПользовательскиеНастройкиКД - ПользовательскиеНастройкиКомпоновкиДанных - пользовательские настройки 
//
Процедура НастроитьПараметрыОтчетаПоВариантуОтчета(НастройкиОтчета, НовыеНастройкиКД, НовыеПользовательскиеНастройкиКД)
	
	ПредопределенныйВариант = ПолучитьПредопределенныйВариант(НастройкиОтчета.ВариантСсылка);
	
	ПараметрДанныеОтчета = СхемаКомпоновкиДанных.Параметры.Найти("ДанныеОтчета");
	ПараметрПоПредприятию = СхемаКомпоновкиДанных.Параметры.Найти("ПоПредприятию");
	
	СписокВыбора = Новый СписокЗначений;
	
	Если ПредопределенныйВариант.КлючВарианта = "СебестоимостьТоваровПоПредприятию"
	 ИЛИ ПредопределенныйВариант.КлючВарианта = "СебестоимостьТоваровПоОперациямПоПредприятию"
	 ИЛИ ПредопределенныйВариант.КлючВарианта = "ДинамикаЗакупокПредприятия" Тогда
		
		СписокВыбора.Добавить(1, НСтр("ru = 'В валюте упр. учета с НДС'"));
		СписокВыбора.Добавить(2, НСтр("ru = 'В валюте упр. учета без НДС'"));
		ПараметрПоПредприятию.Значение = Истина;
		
	Иначе
		
		Если РасчетСебестоимостиПовтИсп.УправленческийУчетОрганизаций() Тогда
			СписокВыбора.Добавить(3, НСтр("ru = 'В валюте упр. учета'"));
		КонецЕсли;
		СписокВыбора.Добавить(4, НСтр("ru = 'В валюте регл. учета'"));
		ПараметрПоПредприятию.Значение = Ложь;
		
	КонецЕсли;
	
	ПараметрДанныеОтчета.УстановитьДоступныеЗначения(СписокВыбора);
	
	Если НовыеНастройкиКД = Неопределено
		Или НовыеПользовательскиеНастройкиКД = Неопределено Тогда
		Возврат;
	КонецЕсли;
	
	ЗначениеПараметраДанныеОтчета = НовыеНастройкиКД.ПараметрыДанных.НайтиЗначениеПараметра(Новый ПараметрКомпоновкиДанных("ДанныеОтчета"));
	НастройкаДанныеОтчета = НовыеПользовательскиеНастройкиКД.Элементы.Найти(ЗначениеПараметраДанныеОтчета.ИдентификаторПользовательскойНастройки);
	Если Не НастройкаДанныеОтчета = Неопределено
		И СписокВыбора.НайтиПоЗначению(НастройкаДанныеОтчета.Значение) = Неопределено Тогда
		НастройкаДанныеОтчета.Значение = СписокВыбора[0].Значение;
	КонецЕсли;
	
КонецПроцедуры

Функция ПолучитьПредопределенныйВариант(Знач Вариант)
	
	КлючиВариантов = Новый Массив;
	КлючиВариантов.Добавить("СебестоимостьТоваровБазовая");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямБазовая");
	КлючиВариантов.Добавить("ДинамикаЗакупокПредприятия");
	КлючиВариантов.Добавить("ДинамикаЗакупокОрганизаций");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОрганизациям");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямПоОрганизациям");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоПредприятию");
	КлючиВариантов.Добавить("СебестоимостьТоваровПоОперациямПоПредприятию");
	
	// Если вариант не задан, то возьмем первый из списка по умолчанию
	Если Вариант = Неопределено Тогда
		Возврат Новый Структура("КлючВарианта", КлючиВариантов[0]);
	КонецЕсли;
	
	Пока КлючиВариантов.Найти(Вариант.КлючВарианта) = Неопределено
		И ЗначениеЗаполнено(Вариант.Родитель) Цикл
		Вариант = Вариант.Родитель;
	КонецЦикла;
	
	Возврат Вариант;
	
КонецФункции

Функция ТекстЗапроса()
	
	#Область ОтборПоСегментуНоменклатуры
	ТекстЗапроса = "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ РАЗЛИЧНЫЕ
	|	Сегменты.Номенклатура КАК Номенклатура,
	|	Сегменты.Характеристика КАК Характеристика,
	|	ИСТИНА КАК ИспользуетсяОтборПоСегментуНоменклатуры
	|ПОМЕСТИТЬ ОтборПоСегментуНоменклатуры
	|ИЗ
	|	РегистрСведений.НоменклатураСегмента КАК Сегменты
	|{ГДЕ
	|	Сегменты.Сегмент.* КАК СегментНоменклатуры,
	|	Сегменты.Номенклатура.* КАК Номенклатура,
	|	Сегменты.Характеристика.* КАК Характеристика}
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Номенклатура,
	|	Характеристика,
	|	ИспользуетсяОтборПоСегментуНоменклатуры
	|;";
	#КонецОбласти
	
	#Область ОстаткиИДвижения
	ТекстЗапроса = ТекстЗапроса + "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ОстаткиИДвижения.ПериодСекунда КАК ПериодСекунда,
	|	ОстаткиИДвижения.ПериодДень КАК ПериодДень,
	|	ОстаткиИДвижения.ПериодНеделя КАК ПериодНеделя,
	|	ОстаткиИДвижения.ПериодДекада КАК ПериодДекада,
	|	ОстаткиИДвижения.ПериодМесяц КАК ПериодМесяц,
	|	ОстаткиИДвижения.ПериодКвартал КАК ПериодКвартал,
	|	ОстаткиИДвижения.ПериодПолугодие КАК ПериодПолугодие,
	|	ОстаткиИДвижения.ПериодГод КАК ПериодГод,
	|	ОстаткиИДвижения.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ОстаткиИДвижения.Номенклатура КАК Номенклатура,
	|	ОстаткиИДвижения.ЕдиницаХранения КАК ЕдиницаХранения,
	|	ОстаткиИДвижения.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИДвижения.Характеристика КАК Характеристика,
	|	ОстаткиИДвижения.Серия КАК Серия,
	|	ОстаткиИДвижения.Склад КАК Склад,
	|	ОстаткиИДвижения.Назначение КАК Назначение,
	|	ОстаткиИДвижения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОстаткиИДвижения.Подразделение КАК Подразделение,
	|	ОстаткиИДвижения.ВидЗапасов КАК ВидЗапасов,
	|	ОстаткиИДвижения.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОстаткиИДвижения.Организация КАК Организация,
	|	ОстаткиИДвижения.Партия КАК Партия,
	|	ОстаткиИДвижения.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ОстаткиИДвижения.РазделУчета КАК РазделУчета,
	|	ОстаткиИДвижения.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	ОстаткиИДвижения.СтатьяДоходов КАК СтатьяДоходов,
	|	ОстаткиИДвижения.СтатьяРасходов КАК СтатьяРасходов,
	|	ОстаткиИДвижения.СтатьяДоходовРасходов КАК СтатьяДоходовРасходов,
	|	ОстаткиИДвижения.АналитикаДоходов КАК АналитикаДоходов,
	|	ОстаткиИДвижения.АналитикаРасходов КАК АналитикаРасходов,
	|	ОстаткиИДвижения.АналитикаДоходовРасходов КАК АналитикаДоходовРасходов,
	|	ОстаткиИДвижения.Договор КАК Договор,
	|	ОстаткиИДвижения.Заказ КАК Заказ,
	|	ОстаткиИДвижения.Партнер КАК Партнер,
	|	ОстаткиИДвижения.Контрагент КАК Контрагент,
	|	ОстаткиИДвижения.Соглашение КАК Соглашение,
	|	ОстаткиИДвижения.ТипЗапасов КАК ТипЗапасов,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияПрихода КАК ХозяйственнаяОперацияПрихода,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияРасхода КАК ХозяйственнаяОперацияРасхода,
	|	(ВЫБОР
	|		КОГДА ОстаткиИДвижения.Документ = НЕОПРЕДЕЛЕНО ТОГДА NULL
	|		ИНАЧЕ ОстаткиИДвижения.Документ КОНЕЦ) КАК Документ,
	|	СУММА(ОстаткиИДвижения.КоличествоНачальныйОстаток)КАК КоличествоНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.КоличествоКонечныйОстаток)КАК КоличествоКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ВесНачальныйОстаток)КАК ВесНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ВесКонечныйОстаток)КАК ВесКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ОбъемНачальныйОстаток)КАК ОбъемНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ОбъемКонечныйОстаток)КАК ОбъемКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.СтоимостьПоступленияНачальныйОстаток)КАК СтоимостьПоступленияНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.СтоимостьПоступленияКонечныйОстаток)КАК СтоимостьПоступленияКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ДопРасходыНачальныйОстаток)КАК ДопРасходыНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ДопРасходыКонечныйОстаток)КАК ДопРасходыКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.СтоимостьЗабалансоваяНачальныйОстаток)КАК СтоимостьЗабалансоваяНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.СтоимостьЗабалансоваяКонечныйОстаток)КАК СтоимостьЗабалансоваяКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ТрудозатратыНачальныйОстаток)КАК ТрудозатратыНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ТрудозатратыКонечныйОстаток)КАК ТрудозатратыКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПостоянныеНачальныйОстаток)КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПостоянныеКонечныйОстаток)КАК ПостатейныеПостоянныеКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПеременныеНачальныйОстаток)КАК ПостатейныеПеременныеНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПеременныеКонечныйОстаток)КАК ПостатейныеПеременныеКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.СебестоимостьНачальныйОстаток)КАК СебестоимостьНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.СебестоимостьКонечныйОстаток)КАК СебестоимостьКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.НалоговыйУчетНачальныйОстаток)КАК НалоговыйУчетНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.НалоговыйУчетКонечныйОстаток)КАК НалоговыйУчетКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостояннаяРазницаНачальныйОстаток)КАК ПостояннаяРазницаНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ПостояннаяРазницаКонечныйОстаток)КАК ПостояннаяРазницаКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.ВременнаяРазницаНачальныйОстаток)КАК ВременнаяРазницаНачальныйОстаток,
	|	СУММА(ОстаткиИДвижения.ВременнаяРазницаКонечныйОстаток)КАК ВременнаяРазницаКонечныйОстаток,
	|	СУММА(ОстаткиИДвижения.КоличествоПриход)КАК КоличествоПриход,
	|	СУММА(ОстаткиИДвижения.КоличествоРасход)КАК КоличествоРасход,
	|	СУММА(ОстаткиИДвижения.ВесПриход)КАК ВесПриход,
	|	СУММА(ОстаткиИДвижения.ВесРасход)КАК ВесРасход,
	|	СУММА(ОстаткиИДвижения.ОбъемПриход)КАК ОбъемПриход,
	|	СУММА(ОстаткиИДвижения.ОбъемРасход)КАК ОбъемРасход,
	|	СУММА(ОстаткиИДвижения.СтоимостьПоступленияПриход)КАК СтоимостьПоступленияПриход,
	|	СУММА(ОстаткиИДвижения.СтоимостьПоступленияРасход)КАК СтоимостьПоступленияРасход,
	|	СУММА(ОстаткиИДвижения.ДопРасходыПриход)КАК ДопРасходыПриход,
	|	СУММА(ОстаткиИДвижения.ДопРасходыРасход)КАК ДопРасходыРасход,
	|	СУММА(ОстаткиИДвижения.СтоимостьЗабалансоваяПриход)КАК СтоимостьЗабалансоваяПриход,
	|	СУММА(ОстаткиИДвижения.СтоимостьЗабалансоваяРасход)КАК СтоимостьЗабалансоваяРасход,
	|	СУММА(ОстаткиИДвижения.ТрудозатратыПриход)КАК ТрудозатратыПриход,
	|	СУММА(ОстаткиИДвижения.ТрудозатратыРасход)КАК ТрудозатратыРасход,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПостоянныеПриход)КАК ПостатейныеПостоянныеПриход,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПостоянныеРасход)КАК ПостатейныеПостоянныеРасход,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПеременныеПриход)КАК ПостатейныеПеременныеПриход,
	|	СУММА(ОстаткиИДвижения.ПостатейныеПеременныеРасход)КАК ПостатейныеПеременныеРасход,
	|	СУММА(ОстаткиИДвижения.СебестоимостьПриход)КАК СебестоимостьПриход,
	|	СУММА(ОстаткиИДвижения.СебестоимостьРасход)КАК СебестоимостьРасход,
	|	СУММА(ОстаткиИДвижения.НалоговыйУчетПриход)КАК НалоговыйУчетПриход,
	|	СУММА(ОстаткиИДвижения.НалоговыйУчетРасход)КАК НалоговыйУчетРасход,
	|	СУММА(ОстаткиИДвижения.ПостояннаяРазницаПриход)КАК ПостояннаяРазницаПриход,
	|	СУММА(ОстаткиИДвижения.ПостояннаяРазницаРасход)КАК ПостояннаяРазницаРасход,
	|	СУММА(ОстаткиИДвижения.ВременнаяРазницаПриход)КАК ВременнаяРазницаПриход,
	|	СУММА(ОстаткиИДвижения.ВременнаяРазницаРасход)КАК ВременнаяРазницаРасход
	|{ВЫБРАТЬ
	|	ПериодСекунда,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	Подразделение.*,
	|	ВидЗапасов.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	Партия.*,
	|	АналитикаУчетаПартий.*,
	|	РазделУчета.*,
	|	ХозяйственнаяОперация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор.*,
	|	Заказ.*,
	|	Партнер.*,
	|	Контрагент.*,
	|	Соглашение.*,
	|	ТипЗапасов.*,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода.*,
	|	ХозяйственнаяОперацияРасхода.*,
	|	Документ.*,
	|	КоличествоНачальныйОстаток,
	|	КоличествоКонечныйОстаток,
	|	ВесНачальныйОстаток,
	|	ВесКонечныйОстаток,
	|	ОбъемНачальныйОстаток,
	|	ОбъемКонечныйОстаток,
	|	СтоимостьПоступленияНачальныйОстаток,
	|	СтоимостьПоступленияКонечныйОстаток,
	|	ДопРасходыНачальныйОстаток,
	|	ДопРасходыКонечныйОстаток,
	|	СтоимостьЗабалансоваяНачальныйОстаток,
	|	СтоимостьЗабалансоваяКонечныйОстаток,
	|	ТрудозатратыНачальныйОстаток,
	|	ТрудозатратыКонечныйОстаток,
	|	ПостатейныеПостоянныеНачальныйОстаток,
	|	ПостатейныеПостоянныеКонечныйОстаток,
	|	ПостатейныеПеременныеНачальныйОстаток,
	|	ПостатейныеПеременныеКонечныйОстаток,
	|	СебестоимостьНачальныйОстаток,
	|	СебестоимостьКонечныйОстаток,
	|	НалоговыйУчетНачальныйОстаток,
	|	НалоговыйУчетКонечныйОстаток,
	|	ПостояннаяРазницаНачальныйОстаток,
	|	ПостояннаяРазницаКонечныйОстаток,
	|	ВременнаяРазницаНачальныйОстаток,
	|	ВременнаяРазницаКонечныйОстаток,
	|	КоличествоПриход,
	|	КоличествоРасход,
	|	ВесПриход,
	|	ВесРасход,
	|	ОбъемПриход,
	|	ОбъемРасход,
	|	СтоимостьПоступленияПриход,
	|	СтоимостьПоступленияРасход,
	|	ДопРасходыПриход,
	|	ДопРасходыРасход,
	|	СтоимостьЗабалансоваяПриход,
	|	СтоимостьЗабалансоваяРасход,
	|	ТрудозатратыПриход,
	|	ТрудозатратыРасход,
	|	ПостатейныеПостоянныеПриход,
	|	ПостатейныеПостоянныеРасход,
	|	ПостатейныеПеременныеПриход,
	|	ПостатейныеПеременныеРасход,
	|	СебестоимостьПриход,
	|	СебестоимостьРасход,
	|	НалоговыйУчетПриход,
	|	НалоговыйУчетРасход,
	|	ПостояннаяРазницаПриход,
	|	ПостояннаяРазницаРасход,
	|	ВременнаяРазницаПриход,
	|	ВременнаяРазницаРасход}
	|
	|ПОМЕСТИТЬ ОстаткиИДвижения
	|ИЗ
	| (
	|ВЫБРАТЬ
	|	СебестоимостьТоваровОстатки.ПериодСекунда КАК ПериодСекунда,
	|	СебестоимостьТоваровОстатки.ПериодДень КАК ПериодДень,
	// Заполнение полей Период... должно быть одинаковое во всех подзапросах.
	// Использование выражения НАЧАЛОПЕРИОДА позволяет сформировать поля Период... по одинаковому принципу.
	// Без этого периоды из виртуальной таблицы ОстаткиИОбороты могут отличаться от периодов, полученных через выражения НАЧАЛОПЕРИОДА,
	// что приведет к неправильной группировке по полю Период..., т.к. период полученнй из виртуальной таблицы ОстаткиИОбороты начинается
	// с даты НачалоПериода и будет отличаться от периода, полученного через выражение НАЧАЛОПЕРИОДА, если НачалоПериода не равно началу месяца, 
	// началу недели и т.п.
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодНеделя, НЕДЕЛЯ) КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодДекада, ДЕКАДА) КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодМесяц, МЕСЯЦ) КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодКвартал, КВАРТАЛ) КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодПолугодие, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваровОстатки.ПериодГод, ГОД) КАК ПериодГод,
	|
	|	СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика КАК Характеристика,
	|	АналитикаНоменклатуры.Серия КАК Серия,
	|	АналитикаНоменклатуры.МестоХранения КАК Склад,
	|	АналитикаНоменклатуры.Назначение КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ЗНАЧЕНИЕ(Справочник.СтруктураПредприятия.ПустаяСсылка) КАК Подразделение,
	|	СебестоимостьТоваровОстатки.ВидЗапасов КАК ВидЗапасов,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	СебестоимостьТоваровОстатки.Организация КАК Организация,
	|	СебестоимостьТоваровОстатки.Партия КАК Партия,
	|	СебестоимостьТоваровОстатки.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	СебестоимостьТоваровОстатки.РазделУчета КАК РазделУчета,
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперация,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка) КАК СтатьяДоходов,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяРасходов,
	|	НЕОПРЕДЕЛЕНО КАК СтатьяДоходовРасходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаДоходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаРасходов,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаДоходовРасходов,
	|	НЕОПРЕДЕЛЕНО КАК Договор,
	|	ЗНАЧЕНИЕ(Документ.ЗаказКлиента.ПустаяСсылка) КАК Заказ,
	|	ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка) КАК Партнер,
	|	ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка) КАК Контрагент,
	|	ЗНАЧЕНИЕ(Справочник.СоглашенияСКлиентами.ПустаяСсылка) КАК Соглашение,
	|	ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка) КАК ТипЗапасов,
	|	ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка) КАК ХозяйственнаяОперацияСправочник,
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперацияПрихода,
	|	ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперацияРасхода,
	|	СебестоимостьТоваровОстатки.Регистратор КАК Документ,
	|	ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1
	|			ТОГДА ВЫБОР
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток КАК КоличествоНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		КОГДА &ЕдиницыКоличества = 1
	|			ТОГДА ВЫБОР
	|					КОГДА АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов <> 0
	|						ТОГДА 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|					ИНАЧЕ 0
	|				КОНЕЦ
	|	КОНЕЦ * СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток КАК КоличествоКонечныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаВесУпаковки КАК ВесНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаВесУпаковки КАК ВесКонечныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток * &ТекстЗапросаОбъемУпаковки КАК ОбъемНачальныйОстаток,
	|	СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток * &ТекстЗапросаОбъемУпаковки КАК ОбъемКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьПоступленияНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьПоступленияКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ДопРасходыНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ДопРасходыКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ТрудозатратыНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ТрудозатратыКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПостоянныеКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПеременныеНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПеременныеКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСНачальныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыУпрНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрНачальныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК СебестоимостьНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеСНДСКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеСНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваровОстатки.СтоимостьБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеБезНДСКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеБезНДСКонечныйОстаток
	|				ИНАЧЕ СебестоимостьТоваровОстатки.СтоимостьУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыУпрКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеУпрКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеУпрКонечныйОстаток
	|			КОНЕЦ
	|	КОНЕЦ КАК СебестоимостьКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыРеглНачальныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглНачальныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглНачальныйОстаток - СебестоимостьТоваровОстатки.ПостояннаяРазницаНачальныйОстаток - СебестоимостьТоваровОстатки.ВременнаяРазницаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НалоговыйУчетНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ДопРасходыРеглКонечныйОстаток + СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ТрудозатратыРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПостоянныеРеглКонечныйОстаток + СебестоимостьТоваровОстатки.ПостатейныеПеременныеРеглКонечныйОстаток - СебестоимостьТоваровОстатки.ПостояннаяРазницаКонечныйОстаток - СебестоимостьТоваровОстатки.ВременнаяРазницаКонечныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НалоговыйУчетКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПостояннаяРазницаНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ПостояннаяРазницаКонечныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПостояннаяРазницаКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВременнаяРазницаНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.ВременнаяРазницаКонечныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВременнаяРазницаКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяНачальныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглНачальныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СтоимостьЗабалансоваяНачальныйОстаток,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяКонечныйОстаток
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваровОстатки.СтоимостьЗабалансоваяРеглКонечныйОстаток
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СтоимостьЗабалансоваяКонечныйОстаток,
	|	0 КАК КоличествоПриход,
	|	0 КАК КоличествоРасход,
	|	0 КАК ВесПриход,
	|	0 КАК ВесРасход,
	|	0 КАК ОбъемПриход,
	|	0 КАК ОбъемРасход,
	|	0 КАК СтоимостьПоступленияПриход,
	|	0 КАК СтоимостьПоступленияРасход,
	|	0 КАК ДопРасходыПриход,
	|	0 КАК ДопРасходыРасход,
	|	0 КАК ТрудозатратыПриход,
	|	0 КАК ТрудозатратыРасход,
	|	0 КАК ПостатейныеПостоянныеПриход,
	|	0 КАК ПостатейныеПостоянныеРасход,
	|	0 КАК ПостатейныеПеременныеПриход,
	|	0 КАК ПостатейныеПеременныеРасход,
	|	0 КАК СебестоимостьПриход,
	|	0 КАК СебестоимостьРасход,
	|	0 КАК НалоговыйУчетПриход,
	|	0 КАК НалоговыйУчетРасход,
	|	0 КАК ПостояннаяРазницаПриход,
	|	0 КАК ПостояннаяРазницаРасход,
	|	0 КАК ВременнаяРазницаПриход,
	|	0 КАК ВременнаяРазницаРасход,
	|	0 КАК СтоимостьЗабалансоваяПриход,
	|	0 КАК СтоимостьЗабалансоваяРасход
	|{ВЫБРАТЬ
	|	ПериодСекунда,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	Подразделение.*,
	|	ВидЗапасов.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	Партия.*,
	|	АналитикаУчетаПартий.*,
	|	РазделУчета.*,
	|	ХозяйственнаяОперация.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор.*,
	|	Заказ.*,
	|	Партнер.*,
	|	Контрагент.*,
	|	Соглашение.*,
	|	ТипЗапасов.*,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода.*,
	|	ХозяйственнаяОперацияРасхода.*,
	|	Документ.*,
	|	КоличествоНачальныйОстаток,
	|	КоличествоКонечныйОстаток,
	|	ВесНачальныйОстаток,
	|	ВесКонечныйОстаток,
	|	ОбъемНачальныйОстаток,
	|	ОбъемКонечныйОстаток,
	|	СтоимостьПоступленияНачальныйОстаток,
	|	СтоимостьПоступленияКонечныйОстаток,
	|	ДопРасходыНачальныйОстаток,
	|	ДопРасходыКонечныйОстаток,
	|	ТрудозатратыНачальныйОстаток,
	|	ТрудозатратыКонечныйОстаток,
	|	ПостатейныеПостоянныеНачальныйОстаток,
	|	ПостатейныеПостоянныеКонечныйОстаток,
	|	ПостатейныеПеременныеНачальныйОстаток,
	|	ПостатейныеПеременныеКонечныйОстаток,
	|	СебестоимостьНачальныйОстаток,
	|	СебестоимостьКонечныйОстаток,
	|	НалоговыйУчетНачальныйОстаток,
	|	НалоговыйУчетКонечныйОстаток,
	|	ПостояннаяРазницаНачальныйОстаток,
	|	ПостояннаяРазницаКонечныйОстаток,
	|	ВременнаяРазницаНачальныйОстаток,
	|	ВременнаяРазницаКонечныйОстаток,
	|	СтоимостьЗабалансоваяНачальныйОстаток,
	|	СтоимостьЗабалансоваяКонечныйОстаток,
	|	КоличествоПриход,
	|	КоличествоРасход,
	|	ВесПриход,
	|	ВесРасход,
	|	ОбъемПриход,
	|	ОбъемРасход,
	|	СтоимостьПоступленияПриход,
	|	СтоимостьПоступленияРасход,
	|	ДопРасходыПриход,
	|	ДопРасходыРасход,
	|	ТрудозатратыПриход,
	|	ТрудозатратыРасход,
	|	ПостатейныеПостоянныеПриход,
	|	ПостатейныеПостоянныеРасход,
	|	ПостатейныеПеременныеПриход,
	|	ПостатейныеПеременныеРасход,
	|	СебестоимостьПриход,
	|	СебестоимостьРасход,
	|	НалоговыйУчетПриход,
	|	НалоговыйУчетРасход,
	|	ПостояннаяРазницаПриход,
	|	ПостояннаяРазницаРасход,
	|	ВременнаяРазницаПриход,
	|	ВременнаяРазницаРасход,
	|	СтоимостьЗабалансоваяПриход,
	|	СтоимостьЗабалансоваяРасход}
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|			&НачалоПериода {(&НачалоПериода)}, 
	|			&КонецПериода {(&КонецПериода)}, 
	|			Авто, , 
	|			{
	|				((АналитикаУчетаНоменклатуры.Номенклатура, АналитикаУчетаНоменклатуры.Характеристика) В
	|					(ВЫБРАТЬ
	|						ОтборПоСегментуНоменклатуры.Номенклатура,
	|						ОтборПоСегментуНоменклатуры.Характеристика
	|					ИЗ
	|						ОтборПоСегментуНоменклатуры
	|					ГДЕ
	|						ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|				(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура, 
	|				(АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения, 
	|				(АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов, 
	|				(АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика, 
	|				(АналитикаУчетаНоменклатуры.Серия).* КАК Серия, 
	|				(АналитикаУчетаНоменклатуры.МестоХранения).* КАК Склад, 
	|				(АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение, 
	|				(АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности, 
	|				(Организация).* КАК Организация, 
	|				(ВидЗапасов).* КАК ВидЗапасов,
	|				(Партия).* КАК Партия
	|			}
	|	) КАК СебестоимостьТоваровОстатки
	|		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.Ссылка}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|		ПО (АналитикаПартий.Ссылка = СебестоимостьТоваровОстатки.АналитикаУчетаПартий)}
	|{ГДЕ
	|	СебестоимостьТоваровОстатки.ПериодДень КАК ПериодДень,
	|	СебестоимостьТоваровОстатки.ПериодНеделя КАК ПериодНеделя,
	|	СебестоимостьТоваровОстатки.ПериодДекада КАК ПериодДекада,
	|	СебестоимостьТоваровОстатки.ПериодМесяц КАК ПериодМесяц,
	|	СебестоимостьТоваровОстатки.ПериодКвартал КАК ПериодКвартал,
	|	СебестоимостьТоваровОстатки.ПериодПолугодие КАК ПериодПолугодие,
	|	СебестоимостьТоваровОстатки.ПериодГод КАК ПериодГод,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	СебестоимостьТоваров.Период КАК ПериодСекунда,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕНЬ) КАК ПериодДень,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, НЕДЕЛЯ) КАК ПериодНеделя,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕКАДА) КАК ПериодДекада,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ) КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, КВАРТАЛ) КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ГОД) КАК ПериодГод,
	|	СебестоимостьТоваров.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	АналитикаНоменклатуры.Номенклатура КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика КАК Характеристика,
	|	АналитикаНоменклатуры.Серия КАК Серия,
	|	АналитикаНоменклатуры.МестоХранения КАК Склад,
	|	АналитикаНоменклатуры.Назначение КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	СебестоимостьТоваров.Подразделение КАК Подразделение,
	|	СебестоимостьТоваров.ВидЗапасов КАК ВидЗапасов,
	|	ВЫБОР
	|		КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|			ТОГДА СебестоимостьТоваров.ВидЗапасов.ГруппаФинансовогоУчета
	|		ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|	КОНЕЦ КАК ГруппаФинансовогоУчета,
	|	СебестоимостьТоваров.Организация,
	|	СебестоимостьТоваров.Партия,
	|	СебестоимостьТоваров.АналитикаУчетаПартий,
	|	СебестоимостьТоваров.РазделУчета,
	|	СебестоимостьТоваров.ХозяйственнаяОперация,
	|	СебестоимостьТоваров.СтатьяДоходов,
	|	СебестоимостьТоваров.СтатьяРасходовСписания КАК СтатьяРасходов,
	|	ВЫБОР
	|		КОГДА НЕ СебестоимостьТоваров.СтатьяДоходов.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваров.СтатьяДоходов
	|		КОГДА НЕ СебестоимостьТоваров.СтатьяРасходовСписания.Ссылка ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваров.СтатьяРасходовСписания
	|	КОНЕЦ КАК СтатьяДоходовРасходов,
	|	СебестоимостьТоваров.АналитикаДоходов,
	|	СебестоимостьТоваров.АналитикаРасходов,
	|	ВЫБОР
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.АналитикаДоходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваров.АналитикаДоходов
	|		КОГДА НЕ ТИПЗНАЧЕНИЯ(СебестоимостьТоваров.АналитикаРасходов) ЕСТЬ NULL
	|			ТОГДА СебестоимостьТоваров.АналитикаРасходов
	|	КОНЕЦ КАК АналитикаДоходовРасходов,
	|	ВыручкаИСебестоимостьПродаж.Договор КАК Договор,
	|	ВыручкаИСебестоимостьПродаж.ЗаказКлиента КАК Заказ,
	|	(ВЫБОР
	|		КОГДА НЕ Реестр.Партнер ЕСТЬ NULL ТОГДА Реестр.Партнер
	|		ИНАЧЕ АналитикаПартнеров.Партнер КОНЕЦ) КАК Партнер,
	|	(ВЫБОР
	|		КОГДА НЕ КлючиРеестра.Ключ ЕСТЬ NULL 
	|			И ТИПЗНАЧЕНИЯ(КлючиРеестра.Ключ) = ТИП(Справочник.Контрагенты)
	|			ТОГДА КлючиРеестра.Ключ
	|		ИНАЧЕ АналитикаПартнеров.Контрагент КОНЕЦ) КАК Контрагент,
	|	ВыручкаИСебестоимостьПродаж.Соглашение КАК Соглашение,
	|	ВыручкаИСебестоимостьПродаж.ТипЗапасов КАК ТипЗапасов,
	|	НастройкиХозопераций.Ссылка КАК ХозяйственнаяОперацияСправочник,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ХозяйственнаяОперацияПрихода,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА ИСТИНА
	|		ИНАЧЕ ЛОЖЬ
	|	КОНЕЦ КАК ХозяйственнаяОперацияРасхода,
	|	СебестоимостьТоваров.Регистратор КАК Документ,
	|	0 КАК КоличествоНачальныйОстаток,
	|	0 КАК КоличествоКонечныйОстаток,
	|	0 КАК ВесНачальныйОстаток,
	|	0 КАК ВесКонечныйОстаток,
	|	0 КАК ОбъемНачальныйОстаток,
	|	0 КАК ОбъемКонечныйОстаток,
	|	0 КАК СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК СтоимостьПоступленияКонечныйОстаток,
	|	0 КАК ДопРасходыНачальныйОстаток,
	|	0 КАК ДопРасходыКонечныйОстаток,
	|	0 КАК ТрудозатратыНачальныйОстаток,
	|	0 КАК ТрудозатратыКонечныйОстаток,
	|	0 КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК ПостатейныеПостоянныеКонечныйОстаток,
	|	0 КАК ПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК ПостатейныеПеременныеКонечныйОстаток,
	|	0 КАК СебестоимостьНачальныйОстаток,
	|	0 КАК СебестоимостьКонечныйОстаток,
	|	0 КАК НалоговыйУчетНачальныйОстаток,
	|	0 КАК НалоговыйУчетКонечныйОстаток,
	|	0 КАК ПостояннаяРазницаНачальныйОстаток,
	|	0 КАК ПостояннаяРазницаКонечныйОстаток,
	|	0 КАК ВременнаяРазницаНачальныйОстаток,
	|	0 КАК ВременнаяРазницаКонечныйОстаток,
	|	0 КАК СтоимостьЗабалансоваяНачальныйОстаток,
	|	0 КАК СтоимостьЗабалансоваяКонечныйОстаток,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		ИНАЧЕ 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|	КОНЕЦ * СебестоимостьТоваров.Количество КАК КоличествоПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0
	|			ТОГДА 1
	|		ИНАЧЕ 1 / АналитикаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов
	|	КОНЕЦ * СебестоимостьТоваров.Количество КАК КоличествоРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * СебестоимостьТоваров.Количество * &ТекстЗапросаВесУпаковки КАК ВесПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * СебестоимостьТоваров.Количество * &ТекстЗапросаВесУпаковки КАК ВесРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * СебестоимостьТоваров.Количество * &ТекстЗапросаОбъемУпаковки КАК ОбъемПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * СебестоимостьТоваров.Количество * &ТекстЗапросаОбъемУпаковки КАК ОбъемРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.СтоимостьЗабалансовая
	|				ИНАЧЕ СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.СтоимостьЗабалансовая
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьПоступленияПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.СтоимостьЗабалансовая
	|				ИНАЧЕ СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.СтоимостьЗабалансовая
	|			КОНЕЦ
	|	КОНЕЦ КАК СтоимостьПоступленияРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ДопРасходы
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ДопРасходыБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ДопРасходыУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ДопРасходыРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ДопРасходыБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ДопРасходыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ДопРасходыПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ДопРасходы
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ДопРасходыБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ДопРасходыУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ДопРасходыРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ДопРасходыБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ДопРасходыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ДопРасходыРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Трудозатраты
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.Трудозатраты
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ТрудозатратыУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ТрудозатратыРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.Трудозатраты
	|				ИНАЧЕ СебестоимостьТоваров.ТрудозатратыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ТрудозатратыПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Трудозатраты
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.Трудозатраты
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ТрудозатратыУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ТрудозатратыРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.Трудозатраты
	|				ИНАЧЕ СебестоимостьТоваров.ТрудозатратыУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ТрудозатратыРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ПостатейныеПостоянныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПостоянныеПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ПостатейныеПостоянныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПостоянныеРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПеременныеПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК ПостатейныеПеременныеРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.ДопРасходы + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеСНДС + СебестоимостьТоваров.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.ДопРасходыБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС + СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.ДопРасходыУпр + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.ТрудозатратыУпр + СебестоимостьТоваров.ПостатейныеПостоянныеУпр + СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.ДопРасходыБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС + СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.ДопРасходыУпр + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.ТрудозатратыУпр + СебестоимостьТоваров.ПостатейныеПостоянныеУпр + СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК СебестоимостьПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА СебестоимостьТоваров.Стоимость + СебестоимостьТоваров.ДопРасходы + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеСНДС + СебестоимостьТоваров.ПостатейныеПеременныеСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.ДопРасходыБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС + СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.ДопРасходыУпр + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.ТрудозатратыУпр + СебестоимостьТоваров.ПостатейныеПостоянныеУпр + СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл
	|		ИНАЧЕ ВЫБОР
	|				КОГДА &ПоПредприятию
	|					ТОГДА СебестоимостьТоваров.СтоимостьБезНДС + СебестоимостьТоваров.ДопРасходыБезНДС + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.Трудозатраты + СебестоимостьТоваров.ПостатейныеПостоянныеБезНДС + СебестоимостьТоваров.ПостатейныеПеременныеБезНДС
	|				ИНАЧЕ СебестоимостьТоваров.СтоимостьУпр + СебестоимостьТоваров.ДопРасходыУпр + СебестоимостьТоваров.СтоимостьЗабалансовая + СебестоимостьТоваров.ТрудозатратыУпр + СебестоимостьТоваров.ПостатейныеПостоянныеУпр + СебестоимостьТоваров.ПостатейныеПеременныеУпр
	|			КОНЕЦ
	|	КОНЕЦ КАК СебестоимостьРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл - СебестоимостьТоваров.ПостояннаяРазница - СебестоимостьТоваров.ВременнаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НалоговыйУчетПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьРегл + СебестоимостьТоваров.ДопРасходыРегл + СебестоимостьТоваров.СтоимостьЗабалансоваяРегл + СебестоимостьТоваров.ТрудозатратыРегл + СебестоимостьТоваров.ПостатейныеПостоянныеРегл + СебестоимостьТоваров.ПостатейныеПеременныеРегл - СебестоимостьТоваров.ПостояннаяРазница - СебестоимостьТоваров.ВременнаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК НалоговыйУчетРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостояннаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПостояннаяРазницаПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ПостояннаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ПостояннаяРазницаРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ВременнаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВременнаяРазницаПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА 0
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.ВременнаяРазница
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ВременнаяРазницаРасход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СтоимостьЗабалансоваяПриход,
	|	ВЫБОР
	|		КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|			ТОГДА 1
	|		ИНАЧЕ 0
	|	КОНЕЦ * ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|				ИЛИ &ДанныеОтчета = 2
	|				ИЛИ &ДанныеОтчета = 3
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансовая
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА СебестоимостьТоваров.СтоимостьЗабалансоваяРегл
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК СтоимостьЗабалансоваяРасход
	|ИЗ
	|	РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаНоменклатуры КАК АналитикаНоменклатуры
	|		ПО СебестоимостьТоваров.АналитикаУчетаНоменклатуры = АналитикаНоменклатуры.Ссылка}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиАналитикиУчетаПартий КАК АналитикаПартий
	|		ПО (АналитикаПартий.Ссылка = СебестоимостьТоваров.АналитикаУчетаПартий)}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрНакопления.ВыручкаИСебестоимостьПродаж КАК ВыручкаИСебестоимостьПродаж
	|		ПО СебестоимостьТоваров.ИдентификаторФинЗаписи = ВыручкаИСебестоимостьПродаж.ИдентификаторФинЗаписи}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.АналитикаУчетаПоПартнерам КАК АналитикаПартнеров
	|		ПО СебестоимостьТоваров.АналитикаУчетаПоПартнерам = АналитикаПартнеров.КлючАналитики}
	|		{ЛЕВОЕ СОЕДИНЕНИЕ РегистрСведений.РеестрДокументов КАК Реестр
	|		ПО Реестр.Ссылка = СебестоимостьТоваров.Регистратор
	|			И НЕ Реестр.ДополнительнаяЗапись
	|			И СебестоимостьТоваров.ОперацияУчетаСебестоимости = ЗНАЧЕНИЕ(Перечисление.ОперацииУчетаСебестоимости.ВнешнееПоступление)
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.КлючиРеестраДокументов КАК КлючиРеестра
	|		ПО Реестр.Контрагент = КлючиРеестра.Ссылка
	|		}
	|		ЛЕВОЕ СОЕДИНЕНИЕ Справочник.НастройкиХозяйственныхОпераций КАК НастройкиХозопераций
	|		ПО (НастройкиХозопераций.ХозяйственнаяОперация = СебестоимостьТоваров.ХозяйственнаяОперация)
	|ГДЕ
	|	ВЫБОР
	|			КОГДА &ИсключатьХозОперации = ИСТИНА
	|				ТОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (&ИсключаемыеХозОперации)
	|			ИНАЧЕ ИСТИНА
	|		КОНЕЦ
	|{ГДЕ
	|	(СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода),
	|	((АналитикаНоменклатуры.Номенклатура, АналитикаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	АналитикаНоменклатуры.Номенклатура.* КАК Номенклатура,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	АналитикаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	АналитикаНоменклатуры.Характеристика.* КАК Характеристика,
	|	АналитикаНоменклатуры.Серия.* КАК Серия,
	|	АналитикаНоменклатуры.МестоХранения.* КАК Склад,
	|	АналитикаНоменклатуры.Назначение.* КАК Назначение,
	|	АналитикаНоменклатуры.Назначение.НаправлениеДеятельности.* КАК НаправлениеДеятельности,
	|	СебестоимостьТоваров.Подразделение.* КАК Подразделение,
	|	СебестоимостьТоваров.Организация.* КАК Организация,
	|	СебестоимостьТоваров.ВидЗапасов.* КАК ВидЗапасов,
	|	СебестоимостьТоваров.Партия.* КАК Партия,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕНЬ)) КАК ПериодДень,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, НЕДЕЛЯ)) КАК ПериодНеделя,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕКАДА)) КАК ПериодДекада,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ)) КАК ПериодМесяц,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, КВАРТАЛ)) КАК ПериодКвартал,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ПОЛУГОДИЕ)) КАК ПериодПолугодие,
	|	(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ГОД)) КАК ПериодГод,
	|	(ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваров.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ АналитикаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета}
	|) КАК ОстаткиИДвижения
	|
	|СГРУППИРОВАТЬ ПО
	|	ОстаткиИДвижения.ПериодСекунда,
	|	ОстаткиИДвижения.ПериодДень,
	|	ОстаткиИДвижения.ПериодНеделя,
	|	ОстаткиИДвижения.ПериодДекада,
	|	ОстаткиИДвижения.ПериодМесяц,
	|	ОстаткиИДвижения.ПериодКвартал,
	|	ОстаткиИДвижения.ПериодПолугодие,
	|	ОстаткиИДвижения.ПериодГод,
	|	ОстаткиИДвижения.АналитикаУчетаНоменклатуры,
	|	ОстаткиИДвижения.Номенклатура,
	|	ОстаткиИДвижения.ЕдиницаХранения,
	|	ОстаткиИДвижения.ЕдиницаДляОтчетов,
	|	ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИДвижения.Характеристика,
	|	ОстаткиИДвижения.Серия,
	|	ОстаткиИДвижения.Склад,
	|	ОстаткиИДвижения.Назначение,
	|	ОстаткиИДвижения.НаправлениеДеятельности,
	|	ОстаткиИДвижения.Подразделение,
	|	ОстаткиИДвижения.ВидЗапасов,
	|	ОстаткиИДвижения.ГруппаФинансовогоУчета,
	|	ОстаткиИДвижения.Организация,
	|	ОстаткиИДвижения.Партия,
	|	ОстаткиИДвижения.АналитикаУчетаПартий,
	|	ОстаткиИДвижения.РазделУчета,
	|	ОстаткиИДвижения.ХозяйственнаяОперация,
	|	ОстаткиИДвижения.СтатьяДоходов,
	|	ОстаткиИДвижения.СтатьяРасходов,
	|	ОстаткиИДвижения.СтатьяДоходовРасходов,
	|	ОстаткиИДвижения.АналитикаДоходов,
	|	ОстаткиИДвижения.АналитикаРасходов,
	|	ОстаткиИДвижения.АналитикаДоходовРасходов,
	|	ОстаткиИДвижения.Договор,
	|	ОстаткиИДвижения.Заказ,
	|	ОстаткиИДвижения.Партнер,
	|	ОстаткиИДвижения.Контрагент,
	|	ОстаткиИДвижения.Соглашение,
	|	ОстаткиИДвижения.ТипЗапасов,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияСправочник,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияПрихода,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияРасхода,
	|	(ВЫБОР
	|		КОГДА ОстаткиИДвижения.Документ = НЕОПРЕДЕЛЕНО ТОГДА NULL
	|		ИНАЧЕ ОстаткиИДвижения.Документ КОНЕЦ) // Документ
	|;";
	#КонецОбласти
	
	#Область ДетализацияИсходныхЗатрат
	ТекстЗапроса = ТекстЗапроса + "
	|ВЫБРАТЬ РАЗРЕШЕННЫЕ
	|	ДАТАВРЕМЯ(1, 1, 1) КАК ПериодИсходныхЗатрат,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияСебестоимости.Номенклатура КАК Номенклатура,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияСебестоимости.Характеристика КАК Характеристика,
	|	ДетализацияСебестоимости.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Организация КАК Организация,
	|	ДетализацияСебестоимости.Партия КАК Партия,
	|	ДетализацияСебестоимости.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяРасходовИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности КАК ВидЦенности,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления КАК АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Номенклатура КАК НоменклатураИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Характеристика КАК ХарактеристикаИсходная,
	|	ДетализацияСебестоимости.ДокументПоступления КАК ДокументПоступленияИсходный,
	|	ВЫБОР
	|		КОГДА &ДанныеОтчета = 1
	|			ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|		КОГДА &ДанныеОтчета = 2
	|			ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|		КОГДА &ДанныеОтчета = 3
	|			ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|		КОГДА &ДанныеОтчета = 4
	|			ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|	КОНЕЦ КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	0 КАК ИсходныеДопРасходыНаЕдиницу,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	0 КАК КоличествоПартии
	|ПОМЕСТИТЬ ДетализацияИсходныхЗатрат
	|{ВЫБРАТЬ
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	ВидЗапасов.*,
	|	Организация.*,
	|	Партия.*,
	|	АналитикаУчетаПартий.*,
	|	СтатьяРасходовИсходная.*,
	|	АналитикаУчетаПартийДокументаПоступления.*,
	|	НоменклатураИсходная.*,
	|	ХарактеристикаИсходная.*,
	|	ДокументПоступленияИсходный.*}
	|ИЗ
	|	РегистрСведений.ДетализацияСебестоимостиПартииТоваров КАК ДетализацияСебестоимости
	|ГДЕ
	|	(ДетализацияСебестоимости.Номенклатура, ДетализацияСебестоимости.Характеристика, ДетализацияСебестоимости.ВидЗапасов, ДетализацияСебестоимости.Организация, ДетализацияСебестоимости.Партия, ДетализацияСебестоимости.АналитикаУчетаПартий) В
	|			(ВЫБРАТЬ
	|				ОстаткиИДвижения.Номенклатура,
	|				ОстаткиИДвижения.Характеристика,
	|				ОстаткиИДвижения.ВидЗапасов,
	|				ОстаткиИДвижения.Организация,
	|				ОстаткиИДвижения.Партия,
	|				ОстаткиИДвижения.АналитикаУчетаПартий
	|			ИЗ
	|				ОстаткиИДвижения)
	|{ГДЕ
	|	ДетализацияСебестоимости.Номенклатура.* КАК Номенклатура,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.Характеристика.* КАК Характеристика,
	|	ДетализацияСебестоимости.Организация.* КАК Организация,
	|	ДетализацияСебестоимости.ВидЗапасов.* КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Партия.* КАК Партия}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДАТАВРЕМЯ(1, 1, 1) КАК ПериодИсходныхЗатрат,
	|	НЕОПРЕДЕЛЕНО КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияСебестоимости.Номенклатура КАК Номенклатура,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияСебестоимости.Характеристика КАК Характеристика,
	|	ДетализацияСебестоимости.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Организация КАК Организация,
	|	ДетализацияСебестоимости.Партия КАК Партия,
	|	ДетализацияСебестоимости.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК СтатьяРасходовИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности КАК ВидЦенности,
	|	ЗНАЧЕНИЕ(Справочник.КлючиАналитикиУчетаНоменклатуры.ПустаяСсылка) КАК АналитикаУчетаПартийДокументаПоступления,
	|	ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка) КАК НоменклатураИсходная,
	|	ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка) КАК ХарактеристикаИсходная,
	|	ДетализацияСебестоимости.ДокументПоступления КАК ДокументПоступленияИсходный,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов, ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				ИЛИ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|				ИЛИ НЕ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеДопРасходыНаЕдиницу,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	0 КАК КоличествоПартии
	|ИЗ
	|	РегистрСведений.ДетализацияСебестоимостиПартииТоваровПостатейныеЗатраты КАК ДетализацияСебестоимости
	|ГДЕ
	|	ДетализацияСебестоимости.ПериодРегистрации <= КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
	|{ГДЕ
	|	((ДетализацияСебестоимости.Номенклатура, ДетализацияСебестоимости.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	ДетализацияСебестоимости.Номенклатура.* КАК Номенклатура,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	ДетализацияСебестоимости.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.Характеристика.* КАК Характеристика,
	|	ДетализацияСебестоимости.Организация.* КАК Организация,
	|	ДетализацияСебестоимости.ВидЗапасов.* КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Партия.* КАК Партия}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДАТАВРЕМЯ(1, 1, 1) КАК ПериодИсходныхЗатрат,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика КАК Характеристика,
	|	ДетализацияСебестоимости.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Организация КАК Организация,
	|	ДетализацияСебестоимости.Партия КАК Партия,
	|	ДетализацияСебестоимости.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК СтатьяРасходовИсходная,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК ВидЦенности,
	|	ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Номенклатура КАК НоменклатураИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Характеристика КАК ХарактеристикаИсходная,
	|	ДетализацияСебестоимости.ДокументПоступления КАК ДокументПоступленияИсходный,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	0 КАК ИсходныеДопРасходыНаЕдиницу,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов, ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				ИЛИ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|				ИЛИ НЕ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	ДетализацияСебестоимости.КоличествоПартии КАК КоличествоПартии
	|ИЗ
	|	РегистрСведений.ДетализацияСебестоимостиТоваровПостатейныеЗатраты КАК ДетализацияСебестоимости
	|ГДЕ
	|	ДетализацияСебестоимости.Период МЕЖДУ НАЧАЛОПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачалоПериода, СЕКУНДА, -1), МЕСЯЦ) И КОНЕЦПЕРИОДА(ДОБАВИТЬКДАТЕ(&НачалоПериода, СЕКУНДА, -1), МЕСЯЦ)
	|{ГДЕ
	|	((ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура, ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.* КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика.* КАК Характеристика,
	|	ДетализацияСебестоимости.Организация.* КАК Организация,
	|	ДетализацияСебестоимости.ВидЗапасов.* КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Партия.* КАК Партия}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ДАТАВРЕМЯ(1, 1, 1) КАК ПериодИсходныхЗатрат,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика КАК Характеристика,
	|	ДетализацияСебестоимости.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Организация КАК Организация,
	|	ДетализацияСебестоимости.Партия КАК Партия,
	|	ДетализацияСебестоимости.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК СтатьяРасходовИсходная,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК ВидЦенности,
	|	ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Номенклатура КАК НоменклатураИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Характеристика КАК ХарактеристикаИсходная,
	|	ДетализацияСебестоимости.ДокументПоступления КАК ДокументПоступленияИсходный,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	0 КАК ИсходныеДопРасходыНаЕдиницу,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов, ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				ИЛИ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|				ИЛИ НЕ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	ДетализацияСебестоимости.КоличествоПартии КАК КоличествоПартии
	|ИЗ
	|	РегистрСведений.ДетализацияСебестоимостиТоваровПостатейныеЗатраты КАК ДетализацияСебестоимости
	|ГДЕ
	|	ДетализацияСебестоимости.Период МЕЖДУ НАЧАЛОПЕРИОДА(&КонецПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
	|{ГДЕ
	|	((ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура, ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.* КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика.* КАК Характеристика,
	|	ДетализацияСебестоимости.Организация.* КАК Организация,
	|	ДетализацияСебестоимости.ВидЗапасов.* КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Партия.* КАК Партия}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	НАЧАЛОПЕРИОДА(ДетализацияСебестоимости.Период, МЕСЯЦ) КАК ПериодИсходныхЗатрат,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика КАК Характеристика,
	|	ДетализацияСебестоимости.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Организация КАК Организация, 
	|	ДетализацияСебестоимости.Партия КАК Партия,
	|	ДетализацияСебестоимости.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК СтатьяРасходовИсходная,
	|	ВЫБОР
	|		КОГДА ДетализацияСебестоимости.СтатьяРасходов = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|			ТОГДА ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления.ВидЦенности
	|		ИНАЧЕ ДетализацияСебестоимости.СтатьяРасходов
	|	КОНЕЦ КАК ВидЦенности,
	|	ДетализацияСебестоимости.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Номенклатура КАК НоменклатураИсходная,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатурыДокументаПоступления.Характеристика КАК ХарактеристикаИсходная,
	|	ДетализацияСебестоимости.ДокументПоступления КАК ДокументПоступленияИсходный,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	0 КАК ИсходныеДопРасходыНаЕдиницу,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	0 КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	0 КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	ВЫБОР
	|		КОГДА НЕ(&ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|						ИЛИ НЕ &ДанныеОтчета = 4
	|							И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров))
	|				И 
	|					ЛОЖЬ
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	ВЫБОР
	|		КОГДА ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов, ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка)
	|				ИЛИ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовРегл, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|				ИЛИ НЕ &ДанныеОтчета = 4
	|					И ЕСТЬNULL(ДетализацияСебестоимости.СтатьяРасходов.ВариантРаспределенияРасходовУпр, ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.ПустаяСсылка)) = ЗНАЧЕНИЕ(Перечисление.ВариантыРаспределенияРасходов.НаСебестоимостьТоваров)
	|			ТОГДА ВЫБОР
	|					КОГДА &ДанныеОтчета = 1
	|						ТОГДА ДетализацияСебестоимости.СтоимостьСНДС
	|					КОГДА &ДанныеОтчета = 2
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДС
	|					КОГДА &ДанныеОтчета = 3
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСУпр
	|					КОГДА &ДанныеОтчета = 4
	|						ТОГДА ДетализацияСебестоимости.СтоимостьБезНДСРегл
	|				КОНЕЦ
	|		ИНАЧЕ 0
	|	КОНЕЦ КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	ДетализацияСебестоимости.КоличествоПартии КАК КоличествоПартии
	|ИЗ
	|	РегистрСведений.ДетализацияСебестоимостиТоваровПостатейныеЗатраты КАК ДетализацияСебестоимости
	|ГДЕ
	|	ДетализацияСебестоимости.Период МЕЖДУ НАЧАЛОПЕРИОДА(&НачалоПериода, МЕСЯЦ) И КОНЕЦПЕРИОДА(&КонецПериода, МЕСЯЦ)
	|{ГДЕ
	|	((ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура, ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика) В
	|			(ВЫБРАТЬ
	|				ОтборПоСегментуНоменклатуры.Номенклатура,
	|				ОтборПоСегментуНоменклатуры.Характеристика
	|			ИЗ
	|				ОтборПоСегментуНоменклатуры
	|			ГДЕ
	|				ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры)),
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.* КАК Номенклатура,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|	ДетализацияСебестоимости.АналитикаУчетаНоменклатуры.Характеристика.* КАК Характеристика,
	|	ДетализацияСебестоимости.Организация.* КАК Организация,
	|	ДетализацияСебестоимости.ВидЗапасов.* КАК ВидЗапасов,
	|	ДетализацияСебестоимости.Партия.* КАК Партия}
	|
	|;";
	#КонецОбласти

	#Область ДетализацияСгруппированная
	ТекстЗапроса = ТекстЗапроса + "
	|ВЫБРАТЬ
	|	ДетализацияИсходныхЗатрат.ПериодИсходныхЗатрат КАК ПериодИсходныхЗатрат,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ДетализацияИсходныхЗатрат.Номенклатура КАК Номенклатура,
	|	ДетализацияИсходныхЗатрат.ЕдиницаХранения КАК ЕдиницаХранения,
	|	ДетализацияИсходныхЗатрат.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ДетализацияИсходныхЗатрат.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ДетализацияИсходныхЗатрат.Характеристика КАК Характеристика,
	|	ДетализацияИсходныхЗатрат.ВидЗапасов КАК ВидЗапасов,
	|	ДетализацияИсходныхЗатрат.Организация КАК Организация,
	|	ДетализацияИсходныхЗатрат.Партия КАК Партия,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ДетализацияИсходныхЗатрат.СтатьяРасходовИсходная КАК СтатьяРасходовИсходная,
	|	ДетализацияИсходныхЗатрат.ВидЦенности КАК ВидЦенности,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаПартийДокументаПоступления КАК АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияИсходныхЗатрат.НоменклатураИсходная КАК НоменклатураИсходная,
	|	ДетализацияИсходныхЗатрат.ХарактеристикаИсходная КАК ХарактеристикаИсходная,
	|	ДетализацияИсходныхЗатрат.ДокументПоступленияИсходный КАК ДокументПоступленияИсходный,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеМатериальныеЗатратыНаЕдиницу) КАК ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПостоянныеНаЕдиницу) КАК ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПеременныеНаЕдиницу) КАК ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеДопРасходыНаЕдиницу) КАК ИсходныеДопРасходыНаЕдиницу,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало) КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало) КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало) КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеДопРасходыНаЕдиницуНаНачало) КАК ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец) КАК ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец) КАК ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец) КАК ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеДопРасходыНаЕдиницуНаКонец) КАК ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод) КАК ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод) КАК ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод) КАК ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	СУММА(ДетализацияИсходныхЗатрат.ИсходныеДопРасходыНаЕдиницуЗаПериод) КАК ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	СУММА(ДетализацияИсходныхЗатрат.КоличествоПартии) КАК КоличествоПартии
	|ПОМЕСТИТЬ ДетализацияСгруппированная
	|{ВЫБРАТЬ
	|	ПериодИсходныхЗатрат,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	ВидЗапасов.*,
	|	Организация.*,
	|	Партия.*,
	|	АналитикаУчетаПартий.*,
	|	СтатьяРасходовИсходная.*,
	|	ВидЦенности.*,
	|	АналитикаУчетаПартийДокументаПоступления.*,
	|	НоменклатураИсходная.*,
	|	ХарактеристикаИсходная.*,
	|	ДокументПоступленияИсходный.*,
	|	ИсходныеМатериальныеЗатратыНаЕдиницу,
	|	ИсходныеПостатейныеПостоянныеНаЕдиницу,
	|	ИсходныеПостатейныеПеременныеНаЕдиницу,
	|	ИсходныеДопРасходыНаЕдиницу,
	|	ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало,
	|	ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало,
	|	ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало,
	|	ИсходныеДопРасходыНаЕдиницуНаНачало,
	|	ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец,
	|	ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец,
	|	ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец,
	|	ИсходныеДопРасходыНаЕдиницуНаКонец,
	|	ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод,
	|	ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод,
	|	ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод,
	|	ИсходныеДопРасходыНаЕдиницуЗаПериод,
	|	КоличествоПартии}
	|ИЗ
	|	ДетализацияИсходныхЗатрат КАК ДетализацияИсходныхЗатрат
	|
	|СГРУППИРОВАТЬ ПО
	|	ДетализацияИсходныхЗатрат.ЕдиницаХранения,
	|	ДетализацияИсходныхЗатрат.ЕдиницаДляОтчетов,
	|	ДетализацияИсходныхЗатрат.ХарактеристикаИсходная,
	|	ДетализацияИсходныхЗатрат.СтатьяРасходовИсходная,
	|	ДетализацияИсходныхЗатрат.ВидЦенности,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаНоменклатуры,
	|	ДетализацияИсходныхЗатрат.ПериодИсходныхЗатрат,
	|	ДетализацияИсходныхЗатрат.Партия,
	|	ДетализацияИсходныхЗатрат.Характеристика,
	|	ДетализацияИсходныхЗатрат.ВидЗапасов,
	|	ДетализацияИсходныхЗатрат.Организация,
	|	ДетализацияИсходныхЗатрат.ДокументПоступленияИсходный,
	|	ДетализацияИсходныхЗатрат.Номенклатура,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаПартийДокументаПоступления,
	|	ДетализацияИсходныхЗатрат.АналитикаУчетаПартий,
	|	ДетализацияИсходныхЗатрат.НоменклатураИсходная,
	|	ДетализацияИсходныхЗатрат.КоэффициентЕдиницыДляОтчетов
	|
	|ИНДЕКСИРОВАТЬ ПО
	|	Номенклатура,
	|	Характеристика,
	|	ВидЗапасов,
	|	Организация,
	|	Партия,
	|	АналитикаУчетаПартий,
	|	ПериодИсходныхЗатрат,
	|	АналитикаУчетаНоменклатуры
	|;";
	#КонецОбласти
	
	#Область ОстаткиИОборотыДляСоединенияСДетализацияСгруппированная
	ТекстЗапроса = ТекстЗапроса + "
	|ВЫБРАТЬ
	|	ОстаткиИОбороты.ПериодМесяц КАК ПериодМесяц,
	|	ОстаткиИОбороты.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ОстаткиИОбороты.ВидЗапасов КАК ВидЗапасов,
	|	ОстаткиИОбороты.Организация КАК Организация,
	|	ОстаткиИОбороты.Партия КАК Партия,
	|	ОстаткиИОбороты.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ОстаткиИОбороты.РазделУчета КАК РазделУчета,
	|	ОстаткиИОбороты.Номенклатура КАК Номенклатура,
	|	ОстаткиИОбороты.ЕдиницаХранения КАК ЕдиницаХранения,
	|	ОстаткиИОбороты.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ОстаткиИОбороты.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИОбороты.Характеристика КАК Характеристика,
	|	ОстаткиИОбороты.Серия КАК Серия,
	|	ОстаткиИОбороты.Склад КАК Склад,
	|	ОстаткиИОбороты.Назначение КАК Назначение,
	|	ОстаткиИОбороты.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОстаткиИОбороты.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	СУММА(ОстаткиИОбороты.КоличествоНачальныйОстаток) КАК КоличествоНачальныйОстаток,
	|	СУММА(ОстаткиИОбороты.КоличествоКонечныйОстаток) КАК КоличествоКонечныйОстаток,
	|	СУММА(ОстаткиИОбороты.КоличествоПриход) КАК КоличествоПриход,
	|	СУММА(ОстаткиИОбороты.КоличествоРасход) КАК КоличествоРасход,
	|	СУММА(ОстаткиИОбороты.ДопРасходыПриход) КАК ДопРасходыПриход
	|ПОМЕСТИТЬ ВТ_ОстаткиИДвижения
	|ИЗ
	|	(ВЫБРАТЬ
	|		СебестоимостьТоваровОстатки.Период КАК ПериодМесяц,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваровОстатки.ВидЗапасов КАК ВидЗапасов,
	|		СебестоимостьТоваровОстатки.Организация КАК Организация,
	|		СебестоимостьТоваровОстатки.Партия КАК Партия,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|		СебестоимостьТоваровОстатки.РазделУчета КАК РазделУчета,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Номенклатура КАК Номенклатура,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения КАК ЕдиницаХранения,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Характеристика КАК Характеристика,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Серия КАК Серия,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.МестоХранения КАК Склад,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Назначение КАК Назначение,
	|		СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|		ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваровОстатки.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ СебестоимостьТоваровОстатки.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ КАК ГруппаФинансовогоУчета,
	|		СебестоимостьТоваровОстатки.КоличествоНачальныйОстаток КАК КоличествоНачальныйОстаток,
	|		СебестоимостьТоваровОстатки.КоличествоКонечныйОстаток КАК КоличествоКонечныйОстаток,
	|		0 КАК КоличествоПриход,
	|		0 КАК КоличествоРасход,
	|		0 КАК ДопРасходыПриход
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров.ОстаткиИОбороты(
	|				&НачалоПериода {(&НачалоПериода)},
	|				&КонецПериода {(&КонецПериода)},
	|				Месяц, ,
	|				{
	|					(
	|						(АналитикаУчетаНоменклатуры.Номенклатура, АналитикаУчетаНоменклатуры.Характеристика) В
	|						(ВЫБРАТЬ
	|							ОтборПоСегментуНоменклатуры.Номенклатура,
	|							ОтборПоСегментуНоменклатуры.Характеристика
	|						ИЗ
	|							ОтборПоСегментуНоменклатуры
	|						ГДЕ
	|							ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры
	|						)
	|					),
	|					(АналитикаУчетаНоменклатуры.Номенклатура).* КАК Номенклатура,
	|					(АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения).* КАК ЕдиницаИзмерения,
	|					(АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов).* КАК ЕдиницаДляОтчетов,
	|					(АналитикаУчетаНоменклатуры.Характеристика).* КАК Характеристика,
	|					(АналитикаУчетаНоменклатуры.Серия).* КАК Серия,
	|					(АналитикаУчетаНоменклатуры.МестоХранения).* КАК Склад,
	|					(АналитикаУчетаНоменклатуры.Назначение).* КАК Назначение,
	|					(АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности).* КАК НаправлениеДеятельности,
	|					(Организация).* КАК Организация,
	|					(ВидЗапасов).* КАК ВидЗапасов,
	|					(Партия).* КАК Партия,
	|					ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперация,
	|					ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиДоходов.ПустаяСсылка) КАК СтатьяДоходов,
	|					ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка) КАК СтатьяРасходов,
	|					НЕОПРЕДЕЛЕНО КАК СтатьяДоходовРасходов,
	|					НЕОПРЕДЕЛЕНО КАК АналитикаДоходов,
	|					НЕОПРЕДЕЛЕНО КАК АналитикаРасходов,
	|					НЕОПРЕДЕЛЕНО КАК АналитикаДоходовРасходов,
	|					НЕОПРЕДЕЛЕНО КАК Договор,
	|					ЗНАЧЕНИЕ(Документ.ЗаказКлиента.ПустаяСсылка) КАК Заказ,
	|					ЗНАЧЕНИЕ(Справочник.Партнеры.ПустаяСсылка) КАК Партнер,
	|					ЗНАЧЕНИЕ(Справочник.Контрагенты.ПустаяСсылка) КАК Контрагент,
	|					ЗНАЧЕНИЕ(Справочник.СоглашенияСКлиентами.ПустаяСсылка) КАК Соглашение,
	|					ЗНАЧЕНИЕ(Перечисление.ТипыЗапасов.ПустаяСсылка) КАК ТипЗапасов,
	|					ЗНАЧЕНИЕ(Справочник.НастройкиХозяйственныхОпераций.ПустаяСсылка) КАК ХозяйственнаяОперацияСправочник,
	|					ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперацияПрихода,
	|					ЗНАЧЕНИЕ(Перечисление.ХозяйственныеОперации.ПустаяСсылка) КАК ХозяйственнаяОперацияРасхода
	|				}
	|				
	|		) КАК СебестоимостьТоваровОстатки
	|	
	|	ОБЪЕДИНИТЬ ВСЕ
	|	
	|	ВЫБРАТЬ
	|		НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ),
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.Партия,
	|		СебестоимостьТоваров.АналитикаУчетаПартий,
	|		СебестоимостьТоваров.РазделУчета,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Характеристика,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Серия,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.МестоХранения,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности,
	|		ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваров.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ,
	|		СУММА(0),
	|		СУММА(0),
	|		СУММА(ВЫБОР
	|				КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|					ТОГДА СебестоимостьТоваров.Количество
	|				ИНАЧЕ 0
	|			КОНЕЦ),
	|		СУММА(ВЫБОР
	|				КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Расход)
	|					ТОГДА СебестоимостьТоваров.Количество
	|				ИНАЧЕ 0
	|			КОНЕЦ),
	|		СУММА(ВЫБОР
	|				КОГДА СебестоимостьТоваров.ВидДвижения = ЗНАЧЕНИЕ(ВидДвиженияНакопления.Приход)
	|					ТОГДА ВЫБОР &ДанныеОтчета
	|							КОГДА 1
	|								ТОГДА СебестоимостьТоваров.ДопРасходы
	|							КОГДА 2
	|								ТОГДА СебестоимостьТоваров.ДопРасходыБезНДС
	|							КОГДА 3
	|								ТОГДА СебестоимостьТоваров.ДопРасходыУпр
	|							КОГДА 4
	|								ТОГДА СебестоимостьТоваров.ДопРасходыРегл
	|						КОНЕЦ
	|				ИНАЧЕ 0
	|			КОНЕЦ)
	|	ИЗ
	|		РегистрНакопления.СебестоимостьТоваров КАК СебестоимостьТоваров
	|	ГДЕ
	|		ВЫБОР
	|				КОГДА &ИсключатьХозОперации = ИСТИНА
	|					ТОГДА НЕ СебестоимостьТоваров.ХозяйственнаяОперация В (&ИсключаемыеХозОперации)
	|				ИНАЧЕ ИСТИНА
	|			КОНЕЦ
	|	{ГДЕ
	|		(СебестоимостьТоваров.Период МЕЖДУ &НачалоПериода И &КонецПериода) ,
	|		(
	|			(СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура, СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Характеристика) В
	|				(ВЫБРАТЬ
	|					ОтборПоСегментуНоменклатуры.Номенклатура,
	|					ОтборПоСегментуНоменклатуры.Характеристика
	|				ИЗ
	|					ОтборПоСегментуНоменклатуры
	|				ГДЕ
	|					ОтборПоСегментуНоменклатуры.ИспользуетсяОтборПоСегментуНоменклатуры = &ИспользуетсяОтборПоСегментуНоменклатуры
	|			)
	|		),
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.* КАК Номенклатура,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения.* КАК ЕдиницаИзмерения,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов.* КАК ЕдиницаДляОтчетов,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Характеристика.* КАК Характеристика,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Серия.* КАК Серия,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.МестоХранения.* КАК Склад,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение.* КАК Назначение,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности.* КАК НаправлениеДеятельности,
	|		СебестоимостьТоваров.Подразделение.* КАК Подразделение,
	|		СебестоимостьТоваров.Организация.* КАК Организация,
	|		СебестоимостьТоваров.ВидЗапасов.* КАК ВидЗапасов,
	|		СебестоимостьТоваров.Партия.* КАК Партия,
	|		СебестоимостьТоваров.СтатьяРасходовСписания.* КАК СтатьяРасходов,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕНЬ)) КАК ПериодДень,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, НЕДЕЛЯ)) КАК ПериодНеделя,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ДЕКАДА)) КАК ПериодДекада,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ)) КАК ПериодМесяц,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, КВАРТАЛ)) КАК ПериодКвартал,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ПОЛУГОДИЕ)) КАК ПериодПолугодие,
	|		(НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, ГОД)) КАК ПериодГод,
	|		(ВЫБОР
	|				КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|					ТОГДА СебестоимостьТоваров.ВидЗапасов.ГруппаФинансовогоУчета
	|				ИНАЧЕ СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ).* КАК ГруппаФинансовогоУчета
	|	}
	|	
	|	СГРУППИРОВАТЬ ПО
	|		НАЧАЛОПЕРИОДА(СебестоимостьТоваров.Период, МЕСЯЦ),
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры,
	|		СебестоимостьТоваров.ВидЗапасов,
	|		СебестоимостьТоваров.Организация,
	|		СебестоимостьТоваров.Партия,
	|		СебестоимостьТоваров.АналитикаУчетаПартий,
	|		СебестоимостьТоваров.РазделУчета,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаИзмерения,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ЕдиницаДляОтчетов,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.КоэффициентЕдиницыДляОтчетов,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Характеристика,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Серия,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.МестоХранения,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение,
	|		СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Назначение.НаправлениеДеятельности,
	|		ВЫБОР
	|			КОГДА &ФормироватьВидыЗапасовПоГруппамФинансовогоУчета
	|				ТОГДА СебестоимостьТоваров.ВидЗапасов.ГруппаФинансовогоУчета
	|			ИНАЧЕ СебестоимостьТоваров.АналитикаУчетаНоменклатуры.Номенклатура.ГруппаФинансовогоУчета
	|		КОНЕЦ) КАК ОстаткиИОбороты
	|
	|СГРУППИРОВАТЬ ПО
	|	ОстаткиИОбороты.ПериодМесяц,
	|	ОстаткиИОбороты.АналитикаУчетаНоменклатуры,
	|	ОстаткиИОбороты.ВидЗапасов,
	|	ОстаткиИОбороты.Организация,
	|	ОстаткиИОбороты.Партия,
	|	ОстаткиИОбороты.АналитикаУчетаПартий,
	|	ОстаткиИОбороты.РазделУчета,
	|	ОстаткиИОбороты.Номенклатура,
	|	ОстаткиИОбороты.ЕдиницаХранения,
	|	ОстаткиИОбороты.ЕдиницаДляОтчетов,
	|	ОстаткиИОбороты.КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИОбороты.Характеристика,
	|	ОстаткиИОбороты.Серия,
	|	ОстаткиИОбороты.Склад,
	|	ОстаткиИОбороты.Назначение,
	|	ОстаткиИОбороты.НаправлениеДеятельности,
	|	ОстаткиИОбороты.ГруппаФинансовогоУчета
	|;";
	#КонецОбласти
	
	#Область НаборДанных
	ТекстЗапроса = ТекстЗапроса + "
	|ВЫБРАТЬ
	|	ОстаткиИДвижения.ПериодСекунда КАК ПериодСекунда,
	|	ОстаткиИДвижения.ПериодДень КАК ПериодДень,
	|	ОстаткиИДвижения.ПериодНеделя КАК ПериодНеделя,
	|	ОстаткиИДвижения.ПериодДекада КАК ПериодДекада,
	|	ОстаткиИДвижения.ПериодМесяц КАК ПериодМесяц,
	|	ОстаткиИДвижения.ПериодКвартал КАК ПериодКвартал,
	|	ОстаткиИДвижения.ПериодПолугодие КАК ПериодПолугодие,
	|	ОстаткиИДвижения.ПериодГод КАК ПериодГод,
	|	ОстаткиИДвижения.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ОстаткиИДвижения.Номенклатура КАК Номенклатура,
	|	(ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0 ТОГДА ОстаткиИДвижения.ЕдиницаХранения
	|		КОГДА &ЕдиницыКоличества = 1 ТОГДА ОстаткиИДвижения.ЕдиницаДляОтчетов
	|	КОНЕЦ) КАК ЕдиницаИзмеренияОтчета,
	|	ОстаткиИДвижения.ЕдиницаХранения КАК ЕдиницаХранения,
	|	ОстаткиИДвижения.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИДвижения.Характеристика КАК Характеристика,
	|	ОстаткиИДвижения.Серия КАК Серия,
	|	ОстаткиИДвижения.Склад КАК Склад,
	|	ОстаткиИДвижения.Назначение КАК Назначение,
	|	ОстаткиИДвижения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	ОстаткиИДвижения.Подразделение КАК Подразделение,
	|	ОстаткиИДвижения.ВидЗапасов КАК ВидЗапасов,
	|	ОстаткиИДвижения.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ОстаткиИДвижения.Организация КАК Организация,
	|	ОстаткиИДвижения.Партия КАК Партия,
	|	ОстаткиИДвижения.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ОстаткиИДвижения.РазделУчета КАК РазделУчета,
	|	ОстаткиИДвижения.ХозяйственнаяОперация КАК ХозяйственнаяОперация,
	|	ОстаткиИДвижения.СтатьяДоходов КАК СтатьяДоходов,
	|	ОстаткиИДвижения.СтатьяРасходов КАК СтатьяРасходов,
	|	ОстаткиИДвижения.СтатьяДоходовРасходов КАК СтатьяДоходовРасходов,
	|	ОстаткиИДвижения.АналитикаДоходов КАК АналитикаДоходов,
	|	ОстаткиИДвижения.АналитикаРасходов КАК АналитикаРасходов,
	|	ОстаткиИДвижения.АналитикаДоходовРасходов КАК АналитикаДоходовРасходов,
	|	ОстаткиИДвижения.Договор КАК Договор,
	|	ОстаткиИДвижения.Заказ КАК Заказ,
	|	ОстаткиИДвижения.Партнер КАК Партнер,
	|	ОстаткиИДвижения.Контрагент КАК Контрагент,
	|	ОстаткиИДвижения.Соглашение КАК Соглашение,
	|	ОстаткиИДвижения.ТипЗапасов КАК ТипЗапасов,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияСправочник КАК ХозяйственнаяОперацияСправочник,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияПрихода КАК ХозяйственнаяОперацияПрихода,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияРасхода КАК ХозяйственнаяОперацияРасхода,
	|	(ВЫБОР
	|		КОГДА ОстаткиИДвижения.Документ = НЕОПРЕДЕЛЕНО ТОГДА NULL
	|		ИНАЧЕ ОстаткиИДвижения.Документ КОНЕЦ) КАК Документ,
	|	ОстаткиИДвижения.КоличествоНачальныйОстаток КАК КоличествоНачальныйОстаток,
	|	ОстаткиИДвижения.КоличествоКонечныйОстаток КАК КоличествоКонечныйОстаток,
	|	ОстаткиИДвижения.ВесНачальныйОстаток КАК ВесНачальныйОстаток,
	|	ОстаткиИДвижения.ВесКонечныйОстаток КАК ВесКонечныйОстаток,
	|	ОстаткиИДвижения.ОбъемНачальныйОстаток КАК ОбъемНачальныйОстаток,
	|	ОстаткиИДвижения.ОбъемКонечныйОстаток КАК ОбъемКонечныйОстаток,
	|	ОстаткиИДвижения.СтоимостьПоступленияНачальныйОстаток КАК СтоимостьПоступленияНачальныйОстаток,
	|	ОстаткиИДвижения.СтоимостьПоступленияКонечныйОстаток КАК СтоимостьПоступленияКонечныйОстаток,
	|	ОстаткиИДвижения.ДопРасходыНачальныйОстаток КАК ДопРасходыНачальныйОстаток,
	|	ОстаткиИДвижения.ДопРасходыКонечныйОстаток КАК ДопРасходыКонечныйОстаток,
	|	ОстаткиИДвижения.ТрудозатратыНачальныйОстаток КАК ТрудозатратыНачальныйОстаток,
	|	ОстаткиИДвижения.ТрудозатратыКонечныйОстаток КАК ТрудозатратыКонечныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеНачальныйОстаток КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеКонечныйОстаток КАК ПостатейныеПостоянныеКонечныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПеременныеНачальныйОстаток КАК ПостатейныеПеременныеНачальныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПеременныеКонечныйОстаток КАК ПостатейныеПеременныеКонечныйОстаток,
	|	ОстаткиИДвижения.СебестоимостьНачальныйОстаток КАК СебестоимостьНачальныйОстаток,
	|	ОстаткиИДвижения.СебестоимостьКонечныйОстаток КАК СебестоимостьКонечныйОстаток,
	|	ОстаткиИДвижения.НалоговыйУчетНачальныйОстаток КАК НалоговыйУчетНачальныйОстаток,
	|	ОстаткиИДвижения.НалоговыйУчетКонечныйОстаток КАК НалоговыйУчетКонечныйОстаток,
	|	ОстаткиИДвижения.ПостояннаяРазницаНачальныйОстаток КАК ПостояннаяРазницаНачальныйОстаток,
	|	ОстаткиИДвижения.ПостояннаяРазницаКонечныйОстаток КАК ПостояннаяРазницаКонечныйОстаток,
	|	ОстаткиИДвижения.ВременнаяРазницаНачальныйОстаток КАК ВременнаяРазницаНачальныйОстаток,
	|	ОстаткиИДвижения.ВременнаяРазницаКонечныйОстаток КАК ВременнаяРазницаКонечныйОстаток,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяНачальныйОстаток КАК СтоимостьЗабалансоваяНачальныйОстаток,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяКонечныйОстаток КАК СтоимостьЗабалансоваяКонечныйОстаток,
	|	ОстаткиИДвижения.КоличествоПриход КАК КоличествоПриход,
	|	ОстаткиИДвижения.КоличествоРасход КАК КоличествоРасход,
	|	ОстаткиИДвижения.ВесПриход КАК ВесПриход,
	|	ОстаткиИДвижения.ВесРасход КАК ВесРасход,
	|	ОстаткиИДвижения.ОбъемПриход КАК ОбъемПриход,
	|	ОстаткиИДвижения.ОбъемРасход КАК ОбъемРасход,
	|	ОстаткиИДвижения.СтоимостьПоступленияПриход КАК СтоимостьПоступленияПриход,
	|	ОстаткиИДвижения.СтоимостьПоступленияРасход КАК СтоимостьПоступленияРасход,
	|	ОстаткиИДвижения.ДопРасходыПриход КАК ДопРасходыПриход,
	|	ОстаткиИДвижения.ДопРасходыРасход КАК ДопРасходыРасход,
	|	ОстаткиИДвижения.ТрудозатратыПриход КАК ТрудозатратыПриход,
	|	ОстаткиИДвижения.ТрудозатратыРасход КАК ТрудозатратыРасход,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеПриход КАК ПостатейныеПостоянныеПриход,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеРасход КАК ПостатейныеПостоянныеРасход,
	|	ОстаткиИДвижения.ПостатейныеПеременныеПриход КАК ПостатейныеПеременныеПриход,
	|	ОстаткиИДвижения.ПостатейныеПеременныеРасход КАК ПостатейныеПеременныеРасход,
	|	ОстаткиИДвижения.СебестоимостьПриход КАК СебестоимостьПриход,
	|	ОстаткиИДвижения.СебестоимостьРасход КАК СебестоимостьРасход,
	|	ОстаткиИДвижения.НалоговыйУчетПриход КАК НалоговыйУчетПриход,
	|	ОстаткиИДвижения.НалоговыйУчетРасход КАК НалоговыйУчетРасход,
	|	ОстаткиИДвижения.ПостояннаяРазницаПриход КАК ПостояннаяРазницаПриход,
	|	ОстаткиИДвижения.ПостояннаяРазницаРасход КАК ПостояннаяРазницаРасход,
	|	ОстаткиИДвижения.ВременнаяРазницаПриход КАК ВременнаяРазницаПриход,
	|	ОстаткиИДвижения.ВременнаяРазницаРасход КАК ВременнаяРазницаРасход,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяПриход КАК СтоимостьЗабалансоваяПриход,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяРасход КАК СтоимостьЗабалансоваяРасход,
	|
	|	NULL КАК СтатьяРасходовИсходная,
	|	ЗНАЧЕНИЕ(Перечисление.ВидыЦенностей.ПустаяСсылка) КАК ВидЦенности,
	|	NULL КАК НоменклатураИсходная,
	|	NULL КАК ХарактеристикаИсходная,
	|	NULL КАК ДокументПоступленияИсходный,
	|
	|	0 КАК ДетализацияСтоимостьПоступленияНачальныйОстаток,
	|	0 КАК ДетализацияСтоимостьПоступленияКонечныйОстаток,
	|	0 КАК ДетализацияДопРасходыНачальныйОстаток,
	|	0 КАК ДетализацияДопРасходыКонечныйОстаток,
	|	0 КАК ДетализацияПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК ДетализацияПостатейныеПостоянныеКонечныйОстаток,
	|	0 КАК ДетализацияПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК ДетализацияПостатейныеПеременныеКонечныйОстаток,
	|	0 КАК ДетализацияСебестоимостьНачальныйОстаток,
	|	0 КАК ДетализацияСебестоимостьКонечныйОстаток,
	|	0 КАК ДетализацияСтоимостьПоступленияПриход,
	|	0 КАК ДетализацияСтоимостьПоступленияРасход,
	|	0 КАК ДетализацияДопРасходыПриход,
	|	0 КАК ДетализацияДопРасходыРасход,
	|	0 КАК ДетализацияПостатейныеПостоянныеПриход,
	|	0 КАК ДетализацияПостатейныеПостоянныеРасход,
	|	0 КАК ДетализацияПостатейныеПеременныеПриход,
	|	0 КАК ДетализацияПостатейныеПеременныеРасход,
	|	0 КАК ДетализацияСебестоимостьПриход,
	|	0 КАК ДетализацияСебестоимостьРасход
	|{ВЫБРАТЬ
	|	ПериодСекунда,
	|	ПериодДень,
	|	ПериодНеделя,
	|	ПериодДекада,
	|	ПериодМесяц,
	|	ПериодКвартал,
	|	ПериодПолугодие,
	|	ПериодГод,
	|	АналитикаУчетаНоменклатуры.*,
	|	Номенклатура.*,
	|	ЕдиницаИзмеренияОтчета.*,
	|	ЕдиницаХранения.*,
	|	ЕдиницаДляОтчетов.*,
	|	КоэффициентЕдиницыДляОтчетов,
	|	Характеристика.*,
	|	Серия.*,
	|	Склад.*,
	|	Назначение.*,
	|	НаправлениеДеятельности.*,
	|	Подразделение.*,
	|	ВидЗапасов.*,
	|	ГруппаФинансовогоУчета.*,
	|	Организация.*,
	|	Партия.*,
	|	АналитикаУчетаПартий.*,
	|	РазделУчета.*,
	|	ХозяйственнаяОперация.*,
	|	ВидЦенности.*,
	|	СтатьяДоходов.*,
	|	СтатьяРасходов.*,
	|	СтатьяДоходовРасходов.*,
	|	АналитикаДоходов.*,
	|	АналитикаРасходов.*,
	|	АналитикаДоходовРасходов.*,
	|	Договор.*,
	|	Заказ.*,
	|	Партнер.*,
	|	Контрагент.*,
	|	Соглашение.*,
	|	ТипЗапасов.*,
	|	ХозяйственнаяОперацияСправочник.*,
	|	ХозяйственнаяОперацияПрихода.*,
	|	ХозяйственнаяОперацияРасхода.*,
	|	Документ.*,
	|	КоличествоНачальныйОстаток,
	|	КоличествоКонечныйОстаток,
	|	ВесНачальныйОстаток,
	|	ВесКонечныйОстаток,
	|	ОбъемНачальныйОстаток,
	|	ОбъемКонечныйОстаток,
	|	СтоимостьПоступленияНачальныйОстаток,
	|	СтоимостьПоступленияКонечныйОстаток,
	|	ДопРасходыНачальныйОстаток,
	|	ДопРасходыКонечныйОстаток,
	|	ТрудозатратыНачальныйОстаток,
	|	ТрудозатратыКонечныйОстаток,
	|	ПостатейныеПостоянныеНачальныйОстаток,
	|	ПостатейныеПостоянныеКонечныйОстаток,
	|	ПостатейныеПеременныеНачальныйОстаток,
	|	ПостатейныеПеременныеКонечныйОстаток,
	|	СебестоимостьНачальныйОстаток,
	|	СебестоимостьКонечныйОстаток,
	|	НалоговыйУчетНачальныйОстаток,
	|	НалоговыйУчетКонечныйОстаток,
	|	ПостояннаяРазницаНачальныйОстаток,
	|	ПостояннаяРазницаКонечныйОстаток,
	|	ВременнаяРазницаНачальныйОстаток,
	|	ВременнаяРазницаКонечныйОстаток,
	|	СтоимостьЗабалансоваяНачальныйОстаток,
	|	СтоимостьЗабалансоваяКонечныйОстаток,
	|	КоличествоПриход,
	|	КоличествоРасход,
	|	ВесПриход,
	|	ВесРасход,
	|	ОбъемПриход,
	|	ОбъемРасход,
	|	СтоимостьПоступленияПриход,
	|	СтоимостьПоступленияРасход,
	|	ДопРасходыПриход,
	|	ДопРасходыРасход,
	|	ТрудозатратыПриход,
	|	ТрудозатратыРасход,
	|	ПостатейныеПостоянныеПриход,
	|	ПостатейныеПостоянныеРасход,
	|	ПостатейныеПеременныеПриход,
	|	ПостатейныеПеременныеРасход,
	|	СебестоимостьПриход,
	|	СебестоимостьРасход,
	|	НалоговыйУчетПриход,
	|	НалоговыйУчетРасход,
	|	ПостояннаяРазницаПриход,
	|	ПостояннаяРазницаРасход,
	|	ВременнаяРазницаПриход,
	|	ВременнаяРазницаРасход,
	|	СтоимостьЗабалансоваяПриход,
	|	СтоимостьЗабалансоваяРасход,
	|	СтатьяРасходовИсходная.*,
	|	НоменклатураИсходная.*,
	|	ХарактеристикаИсходная.*,
	|	ДокументПоступленияИсходный.*,
	|	ДетализацияСтоимостьПоступленияНачальныйОстаток,
	|	ДетализацияСтоимостьПоступленияКонечныйОстаток,
	|	ДетализацияДопРасходыНачальныйОстаток,
	|	ДетализацияДопРасходыКонечныйОстаток,
	|	ДетализацияПостатейныеПостоянныеНачальныйОстаток,
	|	ДетализацияПостатейныеПостоянныеКонечныйОстаток,
	|	ДетализацияПостатейныеПеременныеНачальныйОстаток,
	|	ДетализацияПостатейныеПеременныеКонечныйОстаток,
	|	ДетализацияСебестоимостьНачальныйОстаток,
	|	ДетализацияСебестоимостьКонечныйОстаток,
	|	ДетализацияСтоимостьПоступленияПриход,
	|	ДетализацияСтоимостьПоступленияРасход,
	|	ДетализацияДопРасходыПриход,
	|	ДетализацияДопРасходыРасход,
	|	ДетализацияПостатейныеПостоянныеПриход,
	|	ДетализацияПостатейныеПостоянныеРасход,
	|	ДетализацияПостатейныеПеременныеПриход,
	|	ДетализацияПостатейныеПеременныеРасход,
	|	ДетализацияСебестоимостьПриход,
	|	ДетализацияСебестоимостьРасход
	|	}
	|ИЗ
	|	ОстаткиИДвижения КАК ОстаткиИДвижения
	|{ГДЕ
	|	ОстаткиИДвижения.ПериодДень,
	|	ОстаткиИДвижения.ПериодНеделя,
	|	ОстаткиИДвижения.ПериодДекада,
	|	ОстаткиИДвижения.ПериодМесяц,
	|	ОстаткиИДвижения.ПериодКвартал,
	|	ОстаткиИДвижения.ПериодПолугодие,
	|	ОстаткиИДвижения.ПериодГод,
	|	ОстаткиИДвижения.АналитикаУчетаНоменклатуры.*,
	|	ОстаткиИДвижения.Номенклатура.*,
	|	ОстаткиИДвижения.ЕдиницаХранения.*,
	|	ОстаткиИДвижения.ЕдиницаДляОтчетов.*,
	|	ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов,
	|	ОстаткиИДвижения.Характеристика.*,
	|	ОстаткиИДвижения.Серия.*,
	|	ОстаткиИДвижения.Склад.*,
	|	ОстаткиИДвижения.Назначение.*,
	|	ОстаткиИДвижения.НаправлениеДеятельности.*,
	|	ОстаткиИДвижения.Подразделение.*,
	|	ОстаткиИДвижения.ВидЗапасов.*,
	|	ОстаткиИДвижения.ГруппаФинансовогоУчета.*,
	|	ОстаткиИДвижения.Организация.*,
	|	ОстаткиИДвижения.Партия.*,
	|	ОстаткиИДвижения.АналитикаУчетаПартий.*,
	|	ОстаткиИДвижения.РазделУчета.*,
	|	ОстаткиИДвижения.ХозяйственнаяОперация.*,
	|	ОстаткиИДвижения.СтатьяДоходов.*,
	|	ОстаткиИДвижения.СтатьяРасходов.*,
	|	ОстаткиИДвижения.СтатьяДоходовРасходов.*,
	|	ОстаткиИДвижения.АналитикаДоходов.*,
	|	ОстаткиИДвижения.АналитикаРасходов.*,
	|	ОстаткиИДвижения.АналитикаДоходовРасходов.*,
	|	ОстаткиИДвижения.Договор.*,
	|	ОстаткиИДвижения.Заказ.*,
	|	ОстаткиИДвижения.Партнер.*,
	|	ОстаткиИДвижения.Контрагент.*,
	|	ОстаткиИДвижения.Соглашение.*,
	|	ОстаткиИДвижения.ТипЗапасов.*,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияСправочник.*,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияПрихода.*,
	|	ОстаткиИДвижения.ХозяйственнаяОперацияРасхода.*,
	|	ОстаткиИДвижения.Документ,
	|	ОстаткиИДвижения.КоличествоНачальныйОстаток,
	|	ОстаткиИДвижения.КоличествоКонечныйОстаток,
	|	ОстаткиИДвижения.ВесНачальныйОстаток,
	|	ОстаткиИДвижения.ВесКонечныйОстаток,
	|	ОстаткиИДвижения.ОбъемНачальныйОстаток,
	|	ОстаткиИДвижения.ОбъемКонечныйОстаток,
	|	ОстаткиИДвижения.СтоимостьПоступленияНачальныйОстаток,
	|	ОстаткиИДвижения.СтоимостьПоступленияКонечныйОстаток,
	|	ОстаткиИДвижения.ДопРасходыНачальныйОстаток,
	|	ОстаткиИДвижения.ДопРасходыКонечныйОстаток,
	|	ОстаткиИДвижения.ТрудозатратыНачальныйОстаток,
	|	ОстаткиИДвижения.ТрудозатратыКонечныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеНачальныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеКонечныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПеременныеНачальныйОстаток,
	|	ОстаткиИДвижения.ПостатейныеПеременныеКонечныйОстаток,
	|	ОстаткиИДвижения.СебестоимостьНачальныйОстаток,
	|	ОстаткиИДвижения.СебестоимостьКонечныйОстаток,
	|	ОстаткиИДвижения.НалоговыйУчетНачальныйОстаток,
	|	ОстаткиИДвижения.НалоговыйУчетКонечныйОстаток,
	|	ОстаткиИДвижения.ПостояннаяРазницаНачальныйОстаток,
	|	ОстаткиИДвижения.ПостояннаяРазницаКонечныйОстаток,
	|	ОстаткиИДвижения.ВременнаяРазницаНачальныйОстаток,
	|	ОстаткиИДвижения.ВременнаяРазницаКонечныйОстаток,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяНачальныйОстаток,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяКонечныйОстаток,
	|	ОстаткиИДвижения.КоличествоПриход,
	|	ОстаткиИДвижения.КоличествоРасход,
	|	ОстаткиИДвижения.ВесПриход,
	|	ОстаткиИДвижения.ВесРасход,
	|	ОстаткиИДвижения.ОбъемПриход,
	|	ОстаткиИДвижения.ОбъемРасход,
	|	ОстаткиИДвижения.СтоимостьПоступленияПриход,
	|	ОстаткиИДвижения.СтоимостьПоступленияРасход,
	|	ОстаткиИДвижения.ДопРасходыПриход,
	|	ОстаткиИДвижения.ДопРасходыРасход,
	|	ОстаткиИДвижения.ТрудозатратыПриход,
	|	ОстаткиИДвижения.ТрудозатратыРасход,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеПриход,
	|	ОстаткиИДвижения.ПостатейныеПостоянныеРасход,
	|	ОстаткиИДвижения.ПостатейныеПеременныеПриход,
	|	ОстаткиИДвижения.ПостатейныеПеременныеРасход,
	|	ОстаткиИДвижения.СебестоимостьПриход,
	|	ОстаткиИДвижения.СебестоимостьРасход,
	|	ОстаткиИДвижения.НалоговыйУчетПриход,
	|	ОстаткиИДвижения.НалоговыйУчетРасход,
	|	ОстаткиИДвижения.ПостояннаяРазницаПриход,
	|	ОстаткиИДвижения.ПостояннаяРазницаРасход,
	|	ОстаткиИДвижения.ВременнаяРазницаПриход,
	|	ОстаткиИДвижения.ВременнаяРазницаРасход,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяПриход,
	|	ОстаткиИДвижения.СтоимостьЗабалансоваяРасход
	|	}
	|
	|ОБЪЕДИНИТЬ ВСЕ
	|
	|ВЫБРАТЬ
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодСекунда,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодДень,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодНеделя,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодДекада,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодМесяц,
	|	НАЧАЛОПЕРИОДА(ВТ_ОстаткиИДвижения.ПериодМесяц, КВАРТАЛ) КАК ПериодКвартал,
	|	НАЧАЛОПЕРИОДА(ВТ_ОстаткиИДвижения.ПериодМесяц, ПОЛУГОДИЕ) КАК ПериодПолугодие,
	|	НАЧАЛОПЕРИОДА(ВТ_ОстаткиИДвижения.ПериодМесяц, ГОД) КАК ПериодГод,
	|	ВТ_ОстаткиИДвижения.АналитикаУчетаНоменклатуры КАК АналитикаУчетаНоменклатуры,
	|	ВТ_ОстаткиИДвижения.Номенклатура КАК Номенклатура,
	|	(ВЫБОР
	|		КОГДА &ЕдиницыКоличества = 0 ТОГДА ВТ_ОстаткиИДвижения.ЕдиницаХранения
	|		КОГДА &ЕдиницыКоличества = 1 ТОГДА ВТ_ОстаткиИДвижения.ЕдиницаДляОтчетов
	|	КОНЕЦ) КАК ЕдиницаИзмеренияОтчета,
	|	ВТ_ОстаткиИДвижения.ЕдиницаХранения КАК ЕдиницаХранения,
	|	ВТ_ОстаткиИДвижения.ЕдиницаДляОтчетов КАК ЕдиницаДляОтчетов,
	|	ВТ_ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов КАК КоэффициентЕдиницыДляОтчетов,
	|	ВТ_ОстаткиИДвижения.Характеристика КАК Характеристика,
	|	ВТ_ОстаткиИДвижения.Серия КАК Серия,
	|	ВТ_ОстаткиИДвижения.Склад КАК Склад,
	|	ВТ_ОстаткиИДвижения.Назначение КАК Назначение,
	|	ВТ_ОстаткиИДвижения.НаправлениеДеятельности КАК НаправлениеДеятельности,
	|	NULL КАК Подразделение,
	|	ВТ_ОстаткиИДвижения.ВидЗапасов КАК ВидЗапасов,
	|	ВТ_ОстаткиИДвижения.ГруппаФинансовогоУчета КАК ГруппаФинансовогоУчета,
	|	ВТ_ОстаткиИДвижения.Организация КАК Организация,
	|	ВТ_ОстаткиИДвижения.Партия КАК Партия,
	|	ВТ_ОстаткиИДвижения.АналитикаУчетаПартий КАК АналитикаУчетаПартий,
	|	ВТ_ОстаткиИДвижения.РазделУчета КАК РазделУчета,
	|	NULL КАК ХозяйственнаяОперация,
	|	NULL КАК СтатьяДоходов,
	|	NULL КАК СтатьяРасходов,
	|	NULL КАК СтатьяДоходовРасходов,
	|	NULL КАК АналитикаДоходов,
	|	NULL КАК АналитикаРасходов,
	|	NULL КАК АналитикаДоходовРасходов,
	|	NULL КАК Договор,
	|	NULL КАК Заказ,
	|	NULL КАК Партнер,
	|	NULL КАК Контрагент,
	|	NULL КАК Соглашение,
	|	NULL КАК ТипЗапасов,
	|	NULL КАК ХозяйственнаяОперацияСправочник,
	|	NULL КАК ХозяйственнаяОперацияПрихода,
	|	NULL КАК ХозяйственнаяОперацияРасхода,
	|	NULL КАК Документ,
	|	0 КАК КоличествоНачальныйОстаток,
	|	0 КАК КоличествоКонечныйОстаток,
	|	0 КАК ВесНачальныйОстаток,
	|	0 КАК ВесКонечныйОстаток,
	|	0 КАК ОбъемНачальныйОстаток,
	|	0 КАК ОбъемКонечныйОстаток,
	|	0 КАК СтоимостьПоступленияНачальныйОстаток,
	|	0 КАК СтоимостьПоступленияКонечныйОстаток,
	|	0 КАК ДопРасходыНачальныйОстаток,
	|	0 КАК ДопРасходыКонечныйОстаток,
	|	0 КАК ТрудозатратыНачальныйОстаток,
	|	0 КАК ТрудозатратыКонечныйОстаток,
	|	0 КАК ПостатейныеПостоянныеНачальныйОстаток,
	|	0 КАК ПостатейныеПостоянныеКонечныйОстаток,
	|	0 КАК ПостатейныеПеременныеНачальныйОстаток,
	|	0 КАК ПостатейныеПеременныеКонечныйОстаток,
	|	0 КАК СебестоимостьНачальныйОстаток,
	|	0 КАК СебестоимостьКонечныйОстаток,
	|	0 КАК НалоговыйУчетНачальныйОстаток,
	|	0 КАК НалоговыйУчетКонечныйОстаток,
	|	0 КАК ПостояннаяРазницаНачальныйОстаток,
	|	0 КАК ПостояннаяРазницаКонечныйОстаток,
	|	0 КАК ВременнаяРазницаНачальныйОстаток,
	|	0 КАК ВременнаяРазницаКонечныйОстаток,
	|	0 КАК СтоимостьЗабалансоваяНачальныйОстаток,
	|	0 КАК СтоимостьЗабалансоваяКонечныйОстаток,
	|	0 КАК КоличествоПриход,
	|	0 КАК КоличествоРасход,
	|	0 КАК ВесПриход,
	|	0 КАК ВесРасход,
	|	0 КАК ОбъемПриход,
	|	0 КАК ОбъемРасход,
	|	0 КАК СтоимостьПоступленияПриход,
	|	0 КАК СтоимостьПоступленияРасход,
	|	0 КАК ДопРасходыПриход,
	|	0 КАК ДопРасходыРасход,
	|	0 КАК ТрудозатратыПриход,
	|	0 КАК ТрудозатратыРасход,
	|	0 КАК ПостатейныеПостоянныеПриход,
	|	0 КАК ПостатейныеПостоянныеРасход,
	|	0 КАК ПостатейныеПеременныеПриход,
	|	0 КАК ПостатейныеПеременныеРасход,
	|	0 КАК СебестоимостьПриход,
	|	0 КАК СебестоимостьРасход,
	|	0 КАК НалоговыйУчетПриход,
	|	0 КАК НалоговыйУчетРасход,
	|	0 КАК ПостояннаяРазницаПриход,
	|	0 КАК ПостояннаяРазницаРасход,
	|	0 КАК ВременнаяРазницаПриход,
	|	0 КАК ВременнаяРазницаРасход,
	|	0 КАК СтоимостьЗабалансоваяПриход,
	|	0 КАК СтоимостьЗабалансоваяРасход,
	|
	|	ДетализацияСгруппированная.СтатьяРасходовИсходная КАК СтатьяРасходовИсходная,
	|	ДетализацияСгруппированная.ВидЦенности КАК ВидЦенности,
	|	ДетализацияСгруппированная.НоменклатураИсходная КАК НоменклатураИсходная,
	|	ДетализацияСгруппированная.ХарактеристикаИсходная КАК ХарактеристикаИсходная,
	|	ДетализацияСгруппированная.ДокументПоступленияИсходный КАК ДокументПоступленияИсходный,
	|
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало)
	|		* ВТ_ОстаткиИДвижения.КоличествоНачальныйОстаток КАК ДетализацияСтоимостьПоступленияНачальныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец)
	|		* ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток КАК ДетализацияСтоимостьПоступленияКонечныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуНаНачало)
	|		* ВТ_ОстаткиИДвижения.КоличествоНачальныйОстаток КАК ДетализацияДопРасходыНачальныйОстаток,
	|	ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.КоличествоРасход = 0
	|			ТОГДА ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток
	|			ИНАЧЕ 0 
	|		КОНЕЦ +
	|	(ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуНаКонец)
	|		* ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток КАК ДетализацияДопРасходыКонечныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало)
	|		* ВТ_ОстаткиИДвижения.КоличествоНачальныйОстаток КАК ДетализацияПостатейныеПостоянныеНачальныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец)
	|		* ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток КАК ДетализацияПостатейныеПостоянныеКонечныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало)
	|		* ВТ_ОстаткиИДвижения.КоличествоНачальныйОстаток КАК ДетализацияПостатейныеПеременныеНачальныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец)
	|		* ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток КАК ДетализацияПостатейныеПеременныеКонечныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуНаНачало
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуНаНачало
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуНаНачало
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуНаНачало)
	|		* ВТ_ОстаткиИДвижения.КоличествоНачальныйОстаток КАК ДетализацияСебестоимостьНачальныйОстаток,
	|	ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.КоличествоРасход = 0 
	|			ТОГДА ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток
	|			ИНАЧЕ 0 
	|		КОНЕЦ +
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуНаКонец
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуНаКонец
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуНаКонец
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуНаКонец)
	|		* ВТ_ОстаткиИДвижения.КоличествоКонечныйОстаток КАК ДетализацияСебестоимостьКонечныйОстаток,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод)
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.ДопРасходыПриход <> 0
	|			ТОГДА ДетализацияСгруппированная.КоличествоПартии
	|			ИНАЧЕ ВТ_ОстаткиИДвижения.КоличествоПриход КОНЕЦ КАК ДетализацияСтоимостьПоступленияПриход,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод)
	|		* ВТ_ОстаткиИДвижения.КоличествоРасход КАК ДетализацияСтоимостьПоступленияРасход,
	|	(ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод)
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.ДопРасходыПриход <> 0
	|			ТОГДА ДетализацияСгруппированная.КоличествоПартии
	|			ИНАЧЕ ВТ_ОстаткиИДвижения.КоличествоПриход КОНЕЦ КАК ДетализацияДопРасходыПриход,
	|	(ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод)
	|		* ВТ_ОстаткиИДвижения.КоличествоРасход КАК ДетализацияДопРасходыРасход,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод)
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.ДопРасходыПриход <> 0
	|			ТОГДА ДетализацияСгруппированная.КоличествоПартии
	|			ИНАЧЕ ВТ_ОстаткиИДвижения.КоличествоПриход КОНЕЦ КАК ДетализацияПостатейныеПостоянныеПриход,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод)
	|		* ВТ_ОстаткиИДвижения.КоличествоРасход КАК ДетализацияПостатейныеПостоянныеРасход,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод)
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.ДопРасходыПриход <> 0
	|			ТОГДА ДетализацияСгруппированная.КоличествоПартии
	|			ИНАЧЕ ВТ_ОстаткиИДвижения.КоличествоПриход КОНЕЦ КАК ДетализацияПостатейныеПеременныеПриход,
	|	(ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод)
	|		* ВТ_ОстаткиИДвижения.КоличествоРасход КАК ДетализацияПостатейныеПеременныеРасход,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод)
	|		* ВЫБОР КОГДА ВТ_ОстаткиИДвижения.КоличествоПриход = 0 И ВТ_ОстаткиИДвижения.ДопРасходыПриход <> 0
	|			ТОГДА ДетализацияСгруппированная.КоличествоПартии
	|			ИНАЧЕ ВТ_ОстаткиИДвижения.КоличествоПриход КОНЕЦ КАК ДетализацияСебестоимостьПриход,
	|	(ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеМатериальныеЗатратыНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеДопРасходыНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПостоянныеНаЕдиницуЗаПериод
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницу
	|	+ ДетализацияСгруппированная.ИсходныеПостатейныеПеременныеНаЕдиницуЗаПериод)
	|		* ВТ_ОстаткиИДвижения.КоличествоРасход КАК ДетализацияСебестоимостьРасход
	|ИЗ
	|	ДетализацияСгруппированная КАК ДетализацияСгруппированная
	|		ВНУТРЕННЕЕ СОЕДИНЕНИЕ ВТ_ОстаткиИДвижения КАК ВТ_ОстаткиИДвижения
	|		ПО ВТ_ОстаткиИДвижения.Номенклатура = ДетализацияСгруппированная.Номенклатура
	|			И ВТ_ОстаткиИДвижения.Характеристика = ДетализацияСгруппированная.Характеристика
	|			И ВТ_ОстаткиИДвижения.ВидЗапасов = ДетализацияСгруппированная.ВидЗапасов
	|			И ВТ_ОстаткиИДвижения.Организация = ДетализацияСгруппированная.Организация
	|			И ВТ_ОстаткиИДвижения.Партия = ДетализацияСгруппированная.Партия
	|			И ВТ_ОстаткиИДвижения.АналитикаУчетаПартий = ДетализацияСгруппированная.АналитикаУчетаПартий
	|			И (ВЫБОР
	|				КОГДА ДетализацияСгруппированная.ПериодИсходныхЗатрат = ДАТАВРЕМЯ(1, 1, 1)
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ВТ_ОстаткиИДвижения.ПериодМесяц = ДетализацияСгруппированная.ПериодИсходныхЗатрат
	|			КОНЕЦ)
	|			И (ВЫБОР
	|				КОГДА ДетализацияСгруппированная.АналитикаУчетаНоменклатуры = НЕОПРЕДЕЛЕНО
	|					ТОГДА ИСТИНА
	|				ИНАЧЕ ВТ_ОстаткиИДвижения.АналитикаУчетаНоменклатуры = ДетализацияСгруппированная.АналитикаУчетаНоменклатуры
	|			КОНЕЦ)
	|{ГДЕ
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодДень,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодНеделя,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодДекада,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодМесяц,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодКвартал,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодПолугодие,
	|	ВТ_ОстаткиИДвижения.ПериодМесяц КАК ПериодГод,
	|	ВТ_ОстаткиИДвижения.АналитикаУчетаНоменклатуры.*,
	|	ВТ_ОстаткиИДвижения.Номенклатура.*,
	|	ВТ_ОстаткиИДвижения.ЕдиницаХранения.*,
	|	ВТ_ОстаткиИДвижения.ЕдиницаДляОтчетов.*,
	|	ВТ_ОстаткиИДвижения.КоэффициентЕдиницыДляОтчетов,
	|	ВТ_ОстаткиИДвижения.Характеристика.*,
	|	ВТ_ОстаткиИДвижения.Серия.*,
	|	ВТ_ОстаткиИДвижения.Склад.*,
	|	ВТ_ОстаткиИДвижения.Назначение.*,
	|	ВТ_ОстаткиИДвижения.НаправлениеДеятельности.*,
	|	ВТ_ОстаткиИДвижения.ВидЗапасов.*,
	|	ВТ_ОстаткиИДвижения.ГруппаФинансовогоУчета.*,
	|	ВТ_ОстаткиИДвижения.Организация.*,
	|	ВТ_ОстаткиИДвижения.Партия.*,
	|	ВТ_ОстаткиИДвижения.АналитикаУчетаПартий.*,
	|	ВТ_ОстаткиИДвижения.РазделУчета.*,
	|	(ЕСТЬNULL(ДетализацияСгруппированная.НоменклатураИсходная, ЗНАЧЕНИЕ(Справочник.Номенклатура.ПустаяСсылка))).* КАК НоменклатураИсходная,
	|	(ЕСТЬNULL(ДетализацияСгруппированная.ХарактеристикаИсходная, ЗНАЧЕНИЕ(Справочник.ХарактеристикиНоменклатуры.ПустаяСсылка))).* КАК ХарактеристикаИсходная,
	|	(ЕСТЬNULL(ДетализацияСгруппированная.ДокументПоступленияИсходный, НЕОПРЕДЕЛЕНО)).* КАК ДокументПоступленияИсходный,
	|	(ЕСТЬNULL(ДетализацияСгруппированная.СтатьяРасходовИсходная, ЗНАЧЕНИЕ(ПланВидовХарактеристик.СтатьиРасходов.ПустаяСсылка))).* КАК СтатьяРасходовИсходная}
	|";
	#КонецОбласти
	
	Возврат ТекстЗапроса;
	
КонецФункции

#Область НастройкаПараметровОтчета

Процедура УстановитьОбязательныеНастройки(ПользовательскиеНастройкиМодифицированы)
	
	СегментыСервер.ВключитьОтборПоСегментуНоменклатурыВСКД(КомпоновщикНастроек);
	
	ВидыЗапасовПоГФУ = Константы.ФормироватьВидыЗапасовПоГруппамФинансовогоУчета.Получить();
	КомпоновкаДанныхКлиентСервер.УстановитьПараметр(
	КомпоновщикНастроек, 
	"ФормироватьВидыЗапасовПоГруппамФинансовогоУчета", 
	ВидыЗапасовПоГФУ);
	
КонецПроцедуры

Функция ВспомогательныеПараметрыОтчета()
	ВспомогательныеПараметры = Новый Массив;
	
	КлючТекущегоВарианта = "";
	Если КомпоновщикНастроек.Настройки.ДополнительныеСвойства.Свойство("КлючТекущегоВарианта", КлючТекущегоВарианта) Тогда
		Если Не КлючТекущегоВарианта = "ДинамикаЗакупок" Тогда
			ВспомогательныеПараметры.Добавить("Периодичность");
		КонецЕсли;
	КонецЕсли;
	
	ВспомогательныеПараметры.Добавить("КоличественныеИтогиПоЕдИзм");
	
	ВспомогательныеПараметры.Добавить("МаксимумСерийКоличество");
	ВспомогательныеПараметры.Добавить("ВыделениеСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтслеживаемыеАналитики");
	ВспомогательныеПараметры.Добавить("ГрадиентСерийДиаграмм");
	ВспомогательныеПараметры.Добавить("ОтображениеМаркеровТочекДиаграмм");
	
	КомпоновкаДанныхСервер.ДобавитьВспомогательныеПараметрыОтчетаПоФункциональнымОпциям(ВспомогательныеПараметры);
	
	Возврат ВспомогательныеПараметры;
КонецФункции

Функция СтруктураЗаголовковПолей()
	СтруктураЗаголовковПолей = Новый Структура;
	
	СтруктуруЗаголовковПолейЕдиницИзмерений = КомпоновкаДанныхСервер.ЗаголовкиПолейЕдиницИзмерений(КомпоновщикНастроек);
	ОбщегоНазначенияКлиентСервер.ДополнитьСтруктуру(СтруктураЗаголовковПолей, СтруктуруЗаголовковПолейЕдиницИзмерений, Ложь);
	
	Возврат СтруктураЗаголовковПолей;
КонецФункции

Процедура УдалитьПоказателиИзОтборовРасшифровки(КомпоновщикНастроек)
	Если КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.Свойство("РежимРасшифровки")
		И КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.РежимРасшифровки Тогда
		Показатели = Новый Массив;
		Показатели.Добавить("Показатели.Количество.КоличествоНачальныйОстаток");
		Показатели.Добавить("Показатели.Количество.КоличествоПриход");
		Показатели.Добавить("Показатели.Количество.КоличествоРасход");
		Показатели.Добавить("Показатели.Количество.КоличествоКонечныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесНачальныйОстаток");
		Показатели.Добавить("Показатели.Вес.ВесПриход");
		Показатели.Добавить("Показатели.Вес.ВесРасход");
		Показатели.Добавить("Показатели.Вес.ВесКонечныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемНачальныйОстаток");
		Показатели.Добавить("Показатели.Объем.ОбъемПриход");
		Показатели.Добавить("Показатели.Объем.ОбъемРасход");
		Показатели.Добавить("Показатели.Объем.ОбъемКонечныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияНачальныйОстаток");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияПриход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияРасход");
		Показатели.Добавить("Показатели.СтоимостьПоступления.СтоимостьПоступленияКонечныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыНачальныйОстаток");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыПриход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыРасход");
		Показатели.Добавить("Показатели.ДопРасходы.ДопРасходыКонечныйОстаток");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыНачальныйОстаток");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыПриход");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыРасход");
		Показатели.Добавить("Показатели.Трудозатраты.ТрудозатратыКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеПриход");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеРасход");
		Показатели.Добавить("Показатели.ПостатейныеПостоянные.ПостатейныеПостоянныеКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеПриход");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеРасход");
		Показатели.Добавить("Показатели.ПостатейныеПеременные.ПостатейныеПеременныеКонечныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьНачальныйОстаток");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьПриход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьРасход");
		Показатели.Добавить("Показатели.Себестоимость.СебестоимостьКонечныйОстаток");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетНачальныйОстаток");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетПриход");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетРасход");
		Показатели.Добавить("Показатели.НалоговыйУчет.НалоговыйУчетКонечныйОстаток");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаНачальныйОстаток");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаПриход");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаРасход");
		Показатели.Добавить("Показатели.ПостояннаяРазница.ПостояннаяРазницаКонечныйОстаток");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаНачальныйОстаток");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаПриход");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаРасход");
		Показатели.Добавить("Показатели.ВременнаяРазница.ВременнаяРазницаКонечныйОстаток");
		Показатели.Добавить("Показатели.ЗабалансоваяСтоимость.СтоимостьЗабалансоваяНачальныйОстаток");
		Показатели.Добавить("Показатели.ЗабалансоваяСтоимость.СтоимостьЗабалансоваяПриход");
		Показатели.Добавить("Показатели.ЗабалансоваяСтоимость.СтоимостьЗабалансоваяРасход");
		Показатели.Добавить("Показатели.ЗабалансоваяСтоимость.СтоимостьЗабалансоваяКонечныйОстаток");
		
		Для Каждого Показатель Из Показатели Цикл 
			КомпоновкаДанныхСервер.УдалитьЭлементОтбораИзВсехНастроекОтчета(КомпоновщикНастроек, Показатель);
		КонецЦикла;
	КонецЕсли;
КонецПроцедуры

Процедура УдалитьЦеновыеПоказателиИзВыбранныхПолейРасшифровки(КомпоновщикНастроек)
	Если КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.Свойство("РежимРасшифровки")
		И КомпоновщикНастроек.ФиксированныеНастройки.ДополнительныеСвойства.РежимРасшифровки Тогда
		Показатели = Новый Массив;
		Показатели.Добавить("Показатели.ЦенаПоступления.ЦенаПоступленияНачальныйОстаток");
		Показатели.Добавить("Показатели.ЦенаПоступления.ЦенаПоступленияПриход");
		Показатели.Добавить("Показатели.ЦенаПоступления.ЦенаПоступленияРасход");
		Показатели.Добавить("Показатели.ЦенаПоступления.ЦенаПоступленияКонечныйОстаток");
		Показатели.Добавить("Показатели.СредняяЦена.СредняяЦенаНачальныйОстаток");
		Показатели.Добавить("Показатели.СредняяЦена.СредняяЦенаПриход");
		Показатели.Добавить("Показатели.СредняяЦена.СредняяЦенаРасход");
		Показатели.Добавить("Показатели.СредняяЦена.СредняяЦенаКонечныйОстаток");
		
		КомпоновкаДанныхСервер.УдалитьВыбранноеПолеИзВсехНастроекОтчета(КомпоновщикНастроек, Показатели);
	КонецЕсли;
КонецПроцедуры

#КонецОбласти 

#КонецОбласти 

#КонецЕсли
